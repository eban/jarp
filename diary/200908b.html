<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html lang="ja-JP">
<head>
<title>Just another Ruby porter, 2009-8-b</title>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta name="generator" content="nsmm v0.6.3.2(2005/08/18)">
<meta name="author" content="わたなべひろふみ">
<meta http-equiv="Content-Style-Type" content="text/css">
<META http-equiv="Content-Script-Type" content="text/javascript">
<link rel="stylesheet" href="../css/basic.css" type="text/css" media="all">
<link rel="shortcut icon" type="image/x-icon" href="../favicon.ico">
<link rel="icon" type="image/png" href="../favicon.png">
<link rel="alternate" type="application/rss+xml" title="RSS" href="https://eban.github.io/jarp/diary/index.rdf">
<link rev="made" href="&#109;&#x61;&#x69;&#108;&#116;&#111;&#x3A;&#101;&#98;&#x61;&#110;&#64;&#x6F;&#x73;&#x2E;&#x72;&#105;&#109;&#46;&#x6F;&#x72;&#x2E;&#106;&#x70;">
<link rel="index" href="./">
<link rel="prev" href="200908a.html">
<link rel="next" href="200908c.html">

</head>
<body>
<div><h1><span>Just another Ruby porter,</span></h1></div>

<p>〜2009年8月中旬〜</p>
<hr>
<div>
<a href="200908a.html" accesskey=",">&lt;Prev(,)</a> | 
<a href="200908c.html" accesskey=".">Next(.)&gt;</a> | 
<a href="index.html" accesskey="/">Recent(/)&gt;&gt;</a>
| <a href="index.rdf">RDF</a>
</div>

<hr>

<!-- 2009/08/11 start -->
<h2><a name="20090811" href="200908b.html#20090811">2009-08-11 (Tue)</a></h2>
<!-- 2009-08-12 00:29:44 -->

<div class="entry1">
<h3><a name="200908111" title="200908111" href="200908b.html#200908111">■</a> 
[Tips] tail -c 80</h3>
<p>
mencoderの表示をログに残して別の端末からtailで見ようとしても、<br>
LFじゃなくてCRで延々表示してるのでなかなか最後が出てこない。<br>
そこで-cオプションが役に立つ。tail -c 80ぐらいで。<br>
最近はmencoderをbatchで動かしてるのでこんな工夫が必要になったり。
</p>


<!-- section end -->
</div>
<!-- 2009/08/11 end -->



<hr class="hide">
<!-- 2009/08/12 start -->
<h2><a name="20090812" href="200908b.html#20090812">2009-08-12 (Wed)</a></h2>
<!-- 2009-08-13 01:44:22 -->

<div class="entry1">
<h3><a name="200908121" title="200908121" href="200908b.html#200908121">■</a> 
[ニコ動] 『麻生内閣総理大臣と鳩山民主党代表による党首討論』再放送</h3>
<p>
ノーカット版。来場者数は4万を越えていた。<br>
全然討論になってないんだけど面白かった。<br>
ぽぽ山の意味不明さは相変らずではあるが、<br>
ノーカットを拒否するテレビ局のほうも終わってるな。
</p>
<!-- section end -->
</div>
<!-- 2009/08/12 end -->



<hr class="hide">
<!-- 2009/08/13 start -->
<h2><a name="20090813" href="200908b.html#20090813">2009-08-13 (Thu)</a></h2>
<!-- 2009-08-14 01:11:43 -->

<div class="entry1">
<h3><a name="200908131" title="200908131" href="200908b.html#200908131">■</a> 
[Emacs] Emacs 23</h3>
<p>
F11での昨日の更新でEmacs 23になっちゃって日記書きづらいよ。<br>
どうしたもんかな。まずはSKKをなんとかしないと。
</p>
<!-- section end -->
</div>
<!-- 2009/08/13 end -->



<hr class="hide">
<!-- 2009/08/14 start -->
<h2><a name="20090814" href="200908b.html#20090814">2009-08-14 (Fri)</a></h2>

<!-- 2009-08-14 23:14:47 -->

<div class="entry1">
<h3><a name="200908141" title="200908141" href="200908b.html#200908141">■</a> 
[TV] BOSS, 救命病棟24時</h3>
<p>
夏休みなのでのんびりと録っといたBOSSと救命(地震のやつ)の再放送をまとめて観た。<br>
やっぱ救命は2が一番面白いな。
</p>
<!-- section end -->
</div>
<!-- 2009/08/14 end -->



<hr class="hide">
<!-- 2009/08/15 start -->
<h2><a name="20090815" href="200908b.html#20090815">2009-08-15 (Sat)</a></h2>
  

<div class="entry1">
<h3><a name="200908151" title="200908151" href="200908b.html#200908151">■</a> 
[Emacs] Emacs 23の設定がよくわからない</h3>
<p>
なぜかデフォルトがイタリックになってしまいうっとうしい。
</p>

<p>
結局skkは特に問題なくて日記モードがうまいこと動かせなくなったというか、<br>
中途半端というか。どうしたもんかいな。
</p>

<p>
もはやEmacsは日記でしか使ってないので、vimにしちゃうかな。
</p>
<!-- section end -->
</div>
<!-- 2009/08/15 end -->



<hr class="hide">
<!-- 2009/08/16 start -->
<h2><a name="20090816" href="200908b.html#20090816">2009-08-16 (Sun)</a></h2>
<!-- 2009-08-16 22:52:43 -->

<div class="entry1">
<h3><a name="200908161" title="200908161" href="200908b.html#200908161">■</a> 
[Emacs] Emacs 23の設定</h3>
<p>
よくわからないので、~/.emacs*を全部移動して真っ新な状態で立ち上げてみたら、<br>
メニューが出てきて驚いた。メニューバーとかツールバーは使わないので、ずーっと
  (menu-bar-mode nil)
  (tool-bar-mode nil)
としていたからなあ。なかなか新鮮ではある。<br>
OptionsのSet Default Font...で適当にVLゴシックを選んでSave Optionsしたら雛型ができた。<br>
これを元に以前の~/.emacsと統合したら、まあだいたい満足できる感じになった。<br>
フォントはTrueTypeじゃなくてビットマップで十分なんだけどなあ。<br>
これも慣れると逆にビットマップじゃいやだとか思うんだろうか。
</p>

<p>
UTF-8も問題ないな。これもEmacs 23からだったっけ？<br>
って内部コードがUTF-8になったんか。問題ないわけだよ。
</p>

<p>
それはそれとして日記も以前と同じように書けるようになった。
</p>
<!-- section end -->
</div>
<!-- 2009/08/16 end -->



<hr class="hide">
<!-- 2009/08/17 start -->
<h2><a name="20090817" href="200908b.html#20090817">2009-08-17 (Mon)</a></h2>
<!-- 2009-08-18 02:18:43 -->

<div class="entry1">
<h3><a name="200908171" title="200908171" href="200908b.html#200908171">■</a> 
<a href="http://www.commandlinefu.com/commands/view/3006/stream-youtube-url-directly-to-mplayer">[Tips] Stream YouTube URL directly to mplayer</a></h3>
<p>
なんかどっちもうまくいかないので調べてみる。<br>
watch_fullscreenなる文字列はすでにないのでオリジナルが動かないのはこれが原因だな。<br>
</p>

<p>
で08-13のほうは出たり出なかったりとなんだかよくわからない。<br>
と思ったらハッシュの部分が不定なので順番が変わってしまうのが原因のようだ。
</p>

<pre>
s/.*&quot;, &quot;video_id&quot;
</pre>
<p>
のように&quot;video_id&quot;の前の&quot;まで含めてしまっているため
</p>

<pre>
&quot;vq&quot;: null, &quot;video_id&quot;: 
</pre>
<p>
nullが来たときにマッチしなくなってしまう。これは&quot;t&quot;のほうにも言える。<br>
sedの部分は&quot;を除いた形にしたほうが柔軟だな。
</p>

<pre>
sed -n 's/.*, &quot;video_id&quot;: &quot;\([^&quot;]*\)&quot;, &quot;.*, &quot;t&quot;: &quot;\([^&quot;]*\)&quot;, &quot;.*/video_id=\1\&amp;t=\2/p'
</pre>

<p>
ここで作られるURLの最後にfmt=18だの35だの22だのを指定して、<br>
その画質の動画が存在すれば高画質の動画が見られる。<br>
存在の有無はなんかぐりもんがあった気がするので後で調べよう。
</p>
<!-- section end -->
</div>
<!-- 2009/08/17 end -->



<hr class="hide">
<!-- 2009/08/18 start -->
<h2><a name="20090818" href="200908b.html#20090818">2009-08-18 (Tue)</a></h2>
<!-- 2009-12-24 18:43:41 -->

<div class="entry1">
<h3><a name="200908181" title="200908181" href="200908b.html#200908181">■</a> 
[MinGW] Fedora11でmingw32のクロス環境</h3>
<p>
F11からyumでmingw32のクロス環境が使えるので試した。<br>
yum install mingw32-{gcc,w32api}でrubyをmakeできる最低限の環境ができる。<br>
依存関係でその他mingw32-{binutils,cpp,filesystem,runtime},
python-magic, rpmlint<br>
がインストールされる。後ろの2つは関係ないようだが、<br>
mingw32-filesystemがrpmlintを必要とし、rpmlintがpyhon-magicを必要とする。<br>
あと、ライブラリ関係も充実してるのでクロスの環境としては最適なのかもしれない。
</p>

<pre>
mingw32-SDL.noarch                    1.2.13-6.fc11               fedora        
mingw32-atk.noarch                    1.25.2-8.fc11               fedora        
mingw32-atk-static.noarch             1.25.2-8.fc11               fedora        
mingw32-binutils.i586                 2.19.1-4.fc11               fedora        
mingw32-boost.noarch                  1.37.0-4.fc11               updates       
mingw32-boost-static.noarch           1.37.0-4.fc11               updates       
mingw32-bzip2.noarch                  1.0.5-7.fc11                fedora        
mingw32-cairo.noarch                  1.8.6-1.fc11                fedora        
mingw32-cairomm.noarch                1.8.0-1.fc11                fedora        
mingw32-cpp.i586                      4.4.0-0.7.fc11              fedora        
mingw32-crossreport.noarch            6-2.fc11                    fedora        
mingw32-dlfcn.noarch                  0-0.5.r11.fc11              fedora        
mingw32-enchant.noarch                1.5.0-2.fc11                updates       
mingw32-enchant-static.noarch         1.5.0-2.fc11                updates       
mingw32-expat.noarch                  2.0.1-4.fc11                fedora        
mingw32-filesystem.noarch             50-3.fc11.1                 updates       
mingw32-fontconfig.noarch             2.6.0-9.fc11                fedora        
mingw32-freetype.noarch               2.3.8-3.fc11                fedora        
mingw32-gcc.i586                      4.4.0-0.7.fc11              fedora        
mingw32-gcc-c++.i586                  4.4.0-0.7.fc11              fedora        
mingw32-gcc-gfortran.i586             4.4.0-0.7.fc11              fedora        
mingw32-gcc-objc.i586                 4.4.0-0.7.fc11              fedora        
mingw32-gcc-objc++.i586               4.4.0-0.7.fc11              fedora        
mingw32-gdbm.noarch                   1.8.0-4.fc11                fedora        
mingw32-gettext.noarch                0.17-10.fc11                fedora        
mingw32-glib2.noarch                  2.20.1-1.fc11               updates       
mingw32-glib2-static.noarch           2.20.1-1.fc11               updates       
mingw32-glibmm24.noarch               2.20.0-3.fc11               updates       
mingw32-gnutls.noarch                 2.6.4-1.fc11                fedora        
mingw32-gtk-vnc.noarch                0.3.8-5.fc11                fedora        
mingw32-gtk2.noarch                   2.16.1-2.fc11               updates       
mingw32-gtk2-static.noarch            2.16.1-2.fc11               updates       
mingw32-gtkmm24.noarch                2.16.0-1.fc11               updates       
mingw32-hunspell.noarch               1.2.8-6.fc11                updates       
mingw32-hunspell-static.noarch        1.2.8-6.fc11                updates       
mingw32-iconv.noarch                  1.12-9.fc11                 fedora        
mingw32-jasper.noarch                 1.900.1-8.fc11              fedora        
mingw32-libgcrypt.noarch              1.4.4-3.fc11                fedora        
mingw32-libglade2.noarch              2.6.4-2.fc11                updates       
mingw32-libglade2-static.noarch       2.6.4-2.fc11                updates       
mingw32-libglademm24.noarch           2.6.7-6.fc11                updates       
mingw32-libgnurx.noarch               2.5.1-3.fc11                updates       
mingw32-libgnurx-static.noarch        2.5.1-3.fc11                updates       
mingw32-libgpg-error.noarch           1.6-11.fc11                 fedora        
mingw32-libidn.noarch                 1.14-2.fc11                 updates       
mingw32-libidn-static.noarch          1.14-2.fc11                 updates       
mingw32-libjpeg.noarch                6b-10.fc11                  fedora        
mingw32-libltdl.noarch                1.5.26-13.fc11              fedora        
mingw32-liboil.noarch                 0.3.16-1.fc11               fedora        
mingw32-libp11.noarch                 0.2.4-1.fc11                updates       
mingw32-libpng.noarch                 1.2.37-1.fc11               updates       
mingw32-libsigc++20.noarch            2.2.2-6.fc11                fedora        
mingw32-libsoup.noarch                2.26.1-2.fc11               updates       
mingw32-libsoup-static.noarch         2.26.1-2.fc11               updates       
mingw32-libsq3.noarch                 20071018-7.fc11             updates       
mingw32-libsqlite3x.noarch            20071018-7.fc11             updates       
mingw32-libssh2.noarch                1.1-2.fc11                  updates       
mingw32-libssh2-static.noarch         1.1-2.fc11                  updates       
mingw32-libtiff.noarch                3.8.2-17.fc11               updates       
mingw32-libxml++.noarch               2.26.0-1.fc11               updates       
mingw32-libxml2.noarch                2.7.3-2.fc11                updates       
mingw32-libxml2-static.noarch         2.7.3-2.fc11                updates       
mingw32-libxslt.noarch                1.1.24-7.fc11               updates       
mingw32-libxslt-static.noarch         1.1.24-7.fc11               updates       
mingw32-minizip.noarch                1.2.3-16.fc11               updates       
mingw32-nsis.i586                     2.45-1.fc11                 updates       
mingw32-nsiswrapper.noarch            3-4.fc11.2                  updates       
mingw32-opensc.noarch                 0.11.8-1.fc11               updates       
mingw32-openssl.noarch                0.9.8j-6.fc11               updates       
mingw32-openssl-static.noarch         0.9.8j-6.fc11               updates       
mingw32-pango.noarch                  1.23.0-1.fc11               fedora        
mingw32-pango-static.noarch           1.23.0-1.fc11               fedora        
mingw32-pangomm.noarch                2.24.0-1.fc11               fedora        
mingw32-pdcurses.noarch               3.4-5.fc11                  fedora        
mingw32-physfs.noarch                 1.0.1-12.fc11               fedora        
mingw32-pixman.noarch                 0.13.2-4.fc11               fedora        
mingw32-plotmm.noarch                 0.1.2-2.fc11                updates       
mingw32-pthreads.noarch               2.8.0-8.fc11                updates       
mingw32-qt.noarch                     4.5.2-1.fc11                updates       
mingw32-qt-qmake.i586                 4.5.2-1.fc11                updates       
mingw32-qwt.noarch                    5.1.1-6.fc11                fedora        
mingw32-readline.noarch               5.2-6.fc11                  fedora        
mingw32-runtime.noarch                3.15.2-3.fc11               fedora        
mingw32-sqlite.noarch                 3.6.6.2-3.fc11              fedora        
mingw32-tcl.noarch                    8.5.7-5.fc11.1              updates       
mingw32-termcap.noarch                1.3.1-7.fc11                fedora        
mingw32-w32api.noarch                 3.13-3.fc11                 fedora        
mingw32-wpcap.noarch                  4.1.beta5-2.fc11            fedora        
mingw32-wpcap-docs.noarch             4.1.beta5-2.fc11            fedora        
mingw32-wpcap-examples.noarch         4.1.beta5-2.fc11            fedora        
mingw32-zfstream.noarch               20041202-5.fc11             updates       
mingw32-zlib.noarch                   1.2.3-16.fc11               updates       
mingw32-zlib-static.noarch            1.2.3-16.fc11               updates       
</pre>


<!-- section end -->
</div>
<!-- 2009/08/18 end -->



<hr class="hide">
<!-- 2009/08/19 start -->
<h2><a name="20090819" href="200908b.html#20090819">2009-08-19 (Wed)</a></h2>
<!-- 2009-08-20 01:32:22 -->

<div class="entry1">
<h3><a name="200908191" title="200908191" href="200908b.html#200908191">■</a> 
[Ruby] Fedora 11でmingw32版rubyを作る</h3>
<p>
とりあえずwineとかbinfmt_miscとかは使わない環境での話。<br>
.exeは直接実行はできない。
</p>

<p>
最近のautoconfはintとかのサイズが取れなくなってるようで、<br>
外から指定する必要がある。
</p>

<pre>
ac_cv_sizeof_short=2 \
ac_cv_sizeof_int=4 \
ac_cv_sizeof_long=4 \
ac_cv_sizeof_long_long=8 \
ac_cv_sizeof_size_t=4 \
ac_cv_sizeof_ssize_t=4 \
ac_cv_sizeof_voidp=4 \
ac_cv_sizeof_float=4 \
ac_cv_sizeof_double=8 \
ac_cv_sizeof_time_t=4 \
ac_cv_sizeof_int8_t=1 \
ac_cv_sizeof_uint8_t=1 \
ac_cv_sizeof_int16_t=2 \
ac_cv_sizeof_uint16_t=2 \
ac_cv_sizeof_int32_t=4 \
ac_cv_sizeof_uint32_t=4 \
ac_cv_sizeof_int64_t=8 \
ac_cv_sizeof_uint64_t=8 \
ac_cv_sizeof_intptr_t=4 \
ac_cv_sizeof_uintptr_t=4 \
ac_cv_sizeof_ptrdiff_t=4 \
../ruby/trunk/configure \
CFLAGS='-Os -mms-bitfields' \
--disable-option-checking \
--host=i686-pc-mingw32 \
--target=i386-mingw32 \
--build=i386-linux \
--with-baseruby=ruby \
--enable-wide-getaddrinfo \
-C \
--prefix=
</pre>
<p>
型のsizeだらけなので、これはconfigure.inにクロスのときはという条件で<br>
入れちゃったほうがよさげ。<br>
クロスコンパイラはi686-pc-mingw32-というprefixがつくので--hostでそれを指定。<br>
trunkはビルド前にもろもろrubyでファイルを作るので<br>
ホスト側で動くrubyを指定する必要がある。このrubyは1.8。<br>
trunk指定ではなぜかエラーになった。あとで調べる。<br>
configureの在処は適当に指定して、あ、それと重要なのは-mms-bitfieldsで、<br>
これをつけないと構造体の空きをパッキングしてくれないとかなんとかで、<br>
バイナリ互換の問題が出るという話。
</p>

<p>
このくらいでmakeは可能。<br>
mingw32-{readline,zlib}をインストールすれば、これらの拡張ライブラリも使える。<br>
ただopensslはmingw32-openssl-staticを試してみたが、残念ながら
</p>

<pre>
ossl_engine.o:ossl_engine.c:(.text+0xc1c): undefined reference to `ENGINE_load_cswift'
ossl_engine.o:ossl_engine.c:(.text+0xc41): undefined reference to `ENGINE_load_chil'
ossl_engine.o:ossl_engine.c:(.text+0xc66): undefined reference to `ENGINE_load_atalla'
ossl_engine.o:ossl_engine.c:(.text+0xc8b): undefined reference to `ENGINE_load_nuron'
ossl_engine.o:ossl_engine.c:(.text+0xcb3): undefined reference to `ENGINE_load_ubsec'
ossl_engine.o:ossl_engine.c:(.text+0xcdb): undefined reference to `ENGINE_load_aep'
ossl_engine.o:ossl_engine.c:(.text+0xd03): undefined reference to `ENGINE_load_sureware'
ossl_engine.o:ossl_engine.c:(.text+0xd2b): undefined reference to `ENGINE_load_4758cca'
</pre>
<p>
とifdefが足りないようだ。
</p>
<!-- section end -->
</div>
<!-- 2009/08/19 end -->



<hr class="hide">
<!-- 2009/08/20 start -->
<h2><a name="20090820" href="200908b.html#20090820">2009-08-20 (Thu)</a></h2>
<!-- 2009-10-04 00:06:47 -->

<div class="entry1">
<h3><a name="200908201" title="200908201" href="200908b.html#200908201">■</a> 
[Ruby] Rubyクロス環境</h3>
<p>
いろいろ試した結果、ターゲットがtrunkならBASERUBYもMINIRUBYも、<br>
trunkのrubyじゃないとだめという結論に。<br>
そのあたりは週末にでもまとめて久し振りにこみる。
</p>

<p>
fake.rbやらrbconfig.rbのバージョンチェックのとこで、<br>
どうすべきか考えないとだめとなかださんからの指摘。<br>

<a href="http://blade.nagaokaut.ac.jp/cgi-bin/scat.rb/ruby/ruby-dev/39081">RUBY VERSIONのMAJOR/MINOR/TEENYは、APIのバージョンという位置づけ</a>
なので、RUBY_VERSIONと食い違いが出てしまう。<br>
ちょっと悩ましい。
</p>
<!-- section end -->
</div>
<!-- 2009/08/20 end -->

<hr>
<div>
<a href="200908a.html">&lt;Prev(,)</a> | 
<a href="200908c.html">Next(.)&gt;</a> | 
<a href="index.html">Recent(/)&gt;&gt;</a>
| <a href="index.rdf">RDF</a>
</div>

<hr>
<!-- SiteSearch Google -->
<form method=GET action="http://www.google.co.jp/search">
<p>
<input type=text name=q size=31 maxlength=255 value="">
<input type=hidden name=hl value="ja">
<input type=hidden name=ie value="UTF-8">
<input type=submit name=btnG value="Google 検索">
<input type=hidden name=domains value="eban.github.io"><br>
<input type=radio name=sitesearch value=""> WWW を検索
<input type=radio name=sitesearch value="eban.github.io" checked> eban.github.io を検索 <br>
</form>

<!-- nsmm v0.6.3.2(2005/08/18) -->

<address><a href="&#109;&#x61;&#x69;&#108;&#116;&#111;&#x3A;&#101;&#98;&#x61;&#110;&#64;&#x6F;&#x73;&#x2E;&#x72;&#105;&#109;&#46;&#x6F;&#x72;&#x2E;&#106;&#x70;">わたなべひろふみ</a><br>
Key fingerprint = C456 1350 085F A320 C6C8  8A36 0F15 9B2E EB12 3885<br>
      <a href="http://validator.w3.org/check?uri=referer"><img
          src="http://www.w3.org/Icons/valid-html401"
          alt="Valid HTML 4.01!" height="16" width="88"></a>

<script type="text/javascript" src="http://trackfeed.com/usr/aa7471e560.js"></script>
</address>

<script src="http://www.google-analytics.com/urchin.js" type="text/javascript">
</script>
<script type="text/javascript">
<!--
_uacct = "UA-101613-1";
urchinTracker();
// -->
</script>
<script src="title.js" type="text/javascript">
</script>
</body>
</html>

<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html lang="ja-JP">
<head>
<title>Just another Ruby porter, 2004-8-a</title>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta name="generator" content="nsmm v0.6.3.2(2005/08/18)">
<meta name="author" content="わたなべひろふみ">
<meta http-equiv="Content-Style-Type" content="text/css">
<META http-equiv="Content-Script-Type" content="text/javascript">
<link rel="stylesheet" href="../css/basic.css" type="text/css" media="all">
<link rel="shortcut icon" type="image/x-icon" href="../favicon.ico">
<link rel="icon" type="image/png" href="../favicon.png">
<link rel="alternate" type="application/rss+xml" title="RSS" href="https://eban.github.io/jarp/diary/index.rdf">
<link rev="made" href="&#109;&#x61;&#x69;&#108;&#116;&#111;&#x3A;&#101;&#98;&#x61;&#110;&#64;&#x6F;&#x73;&#x2E;&#x72;&#105;&#109;&#46;&#x6F;&#x72;&#x2E;&#106;&#x70;">
<link rel="index" href="./">
<link rel="prev" href="200407c.html">
<link rel="next" href="200408b.html">

</head>
<body>
<div><h1><span>Just another Ruby porter,</span></h1></div>

<p>〜2004年8月上旬〜</p>
<hr>
<div>
<a href="200407c.html" accesskey=",">&lt;Prev(,)</a> | 
<a href="200408b.html" accesskey=".">Next(.)&gt;</a> | 
<a href="index.html" accesskey="/">Recent(/)&gt;&gt;</a>
| <a href="index.rdf">RDF</a>
</div>

<hr>

<!-- 2004/08/01 start -->
<h2><a name="20040801" href="200408a.html#20040801">2004-08-01 (Sun)</a></h2>

<div class="entry1">
<h3><a name="200408011" title="200408011" href="200408a.html#200408011">■</a> 
[Linux] ディスク異常</h3>
<p>
昨日のshutdown時のumountがうまくいかなかったのか、なんか一部のファイルが壊れたらしい。
とりあえずKNOPPIXで立ち上げてfsckしてみると、
出るわ出るわでlost+foundにいっぱいたまった。
一応確認してみるとRuby Binariesのインストール用作業ディレクトリのファイル群なので、消しても問題ない。
しかし消せないファイルというかディレクトリが1個。
変な属性が立っちゃったようなので、chattrで落とす。
</p>
<pre>
% ls -l
total 44
d--x------    2 802897   2151695874    45056 Jan  1  1970 Child.src
% lsattr
lsattr: Permission denied While reading flags on ./Child.src
% sudo lsattr
-u---a-A----E-- ./Child.src
% sudo chattr -u -a -A -E Child.src 
usage: chattr [-RV] [-+=AacDdijsSu] [-v version] files...
</pre>
<p>
あれ？複数はだめなのかな。
</p>
<pre>
% sudo chattr -u Child.src 
% sudo chattr -a Child.src
% sudo chattr -A Child.src
% sudo chattr -E Child.src
usage: chattr [-RV] [-+=AacDdijsSu] [-v version] files...
</pre>
<p>
あ、-Eが無効ってことか。
</p>
<pre>
% sudo lsattr             
------------E-- ./Child.src
cow:classes/REXML % sudo chown watanabe:ruby Child.src 
cow:classes/REXML % ls -l
total 44
d--x------    2 watanabe ruby        45056 Jan  1  1970 Child.src
cow:classes/REXML % chmod 0755 *
cow:classes/REXML % ls -l
total 44
drwxr-xr-x    2 watanabe ruby        45056 Jan  1  1970 Child.src
% ls Child.src 
% rmdir Child.src 
</pre>
<p>
うーむ。Eってなんなんだろう？まあいいか。消えたし。
</p>

<!-- section end -->
</div>

<div class="entry0">
<h3><a name="200408012" title="200408012" href="200408a.html#200408012">■</a> 
<a href="http://www.f7.dion.ne.jp/~moorend/news/2004071101.html">「萌え」の起源は平安年間？　『枕草子』から新たな記述発見</a></h3>
<p>
いやー、他の記事を読まなかったら、すっかり騙されてたよ。
</p><blockquote class="cite"><p>
また、今回見つかった文章の中に「紫に萌ゆるをとこ、げにをこがまし。（紫
の上に萌える男はたいそうみっともない）」（２５６段）という、『源氏物語』
の主人公・源氏の君に対する痛烈な批判も含まれており、清少納言の『源氏物
語』観を知るうえで貴重な資料になりそうだ。
</p></blockquote><blockquote class="cite"><p>
さらに、この文脈で用いられている「萌ゆ」の意味が、現在サブカルチャーマ
ニアが用いる「萌え」の意と一致すると、一部研究家から指摘されており、こ
の言葉の起源についての議論にも発展する気配を見せている。
</p></blockquote><p>
しかしサブカルチャーマニアて。

<p>
via 
<a href="http://clip.myblog.jp/rank/click/">クリックランキング</a>
</p>

<!-- section end -->
</div>
<!-- 2004/08/01 end -->



<hr class="hide">
<!-- 2004/08/02 start -->
<h2><a name="20040802" href="200408a.html#20040802">2004-08-02 (Mon)</a></h2>

<div class="entry1">
<h3><a name="200408021" title="200408021" href="200408a.html#200408021">■</a> 
<a href="http://www.fujitv.co.jp/sports/tfr2004/">[TV] ツール・後半総集編</a></h3>
<p>
録っといたビデオを見る。なんとマルコ・パンターニが亡くなっていたとは。
<a href="http://www.cyclingweb.jp/world/news/200402/030682_0215.html">死因不明かあ。</a></p>
<!-- section end -->
</div>
<!-- 2004/08/02 end -->



<hr class="hide">
<!-- 2004/08/03 start -->
<h2><a name="20040803" href="200408a.html#20040803">2004-08-03 (Tue)</a></h2>

<div class="entry1">
<h3><a name="200408031" title="200408031" href="200408a.html#200408031">■</a> 
7月のspam</h3>
<p>
3825通。あれ。減ったよ？
</p>

<!-- section end -->
</div>

<div class="entry0">
<h3><a name="200408032" title="200408032" href="200408a.html#200408032">■</a> 
<a href="http://bogofilter.sf.net/">[Soft] Bogofilter 0.92.4</a></h3>
<p>
Changes:
</p><blockquote class="cite"><p>
Invalid options now cause a warning rather than a program
abortion. The regression tests were revised for %A/%I/%Q. The
bogogrep_static program is now stripped on installation. Miscellaneous
cleanups were done.
</p></blockquote><p>
<!-- section end -->
</div>
<!-- 2004/08/03 end -->



<hr class="hide">
<!-- 2004/08/04 start -->
<h2><a name="20040804" href="200408a.html#20040804">2004-08-04 (Wed)</a></h2>

<div class="entry1">
<h3><a name="200408041" title="200408041" href="200408a.html#200408041">■</a> 
<a href="http://www.thekelleys.org.uk/dnsmasq/doc.html">[Soft] Dnsmasq 2.11</a></h3>
<p>
Changes:
</p><blockquote class="cite"><p>
This release fixes build problems on the latest versions of
FreeBSD-current and a rare DHCP address allocation problem.
</p></blockquote><p>
<!-- section end -->
</div>
<!-- 2004/08/04 end -->



<hr class="hide">
<!-- 2004/08/05 start -->
<h2><a name="20040805" href="200408a.html#20040805">2004-08-05 (Thu)</a></h2>

<div class="entry1">
<h3><a name="200408051" title="200408051" href="200408a.html#200408051">■</a> 
[Cygwin] cygdrive</h3>
<p>
/cygdriveディレクトリを作ることが流行ってるらしいが、そもそも/cygdrive自体が長いよね。
</p>
<pre>
% mount -u -b -c /
</pre>
<p>
とすれば、/c, /dのような感じで各ドライブにアクセスできる。
</p>

<p>
さらに/dev/clipboardを作っとくと、こっちも補完できるようになる。
ただCygwinの外からじゃないと作れない。
</p>
<pre>
C:\cygwin\dev&gt;copy nul clipboard
</pre>

<p>
bashの場合はc:/を使うと補完はc:が無視された形になるので、あまりうれしくない。
一方zshだと問題ない。&quot;:&quot;に何か意味があるのか？
</p>
<!-- section end -->
</div>
<!-- 2004/08/05 end -->



<hr class="hide">
<!-- 2004/08/06 start -->
<h2><a name="20040806" href="200408a.html#20040806">2004-08-06 (Fri)</a></h2>

<div class="entry1">
<h3><a name="200408061" title="200408061" href="200408a.html#200408061">■</a> 
[Mail] 中身のないメール</h3>
<p>
最近Subjectも本文もないメールがよく来るようになった。
spamにもならないし、いったい何がしたいんだ？
テロリストが森に木を隠すように連絡するとかいう話をどこかで読んだけど、
これがそうかな。ほとんどFromしか情報がないんだけど。
</p>

<p>
<a href="http://pcweb.mycom.co.jp/articles/2004/08/02/blackhat1/">記事発見。</a></p>
<!-- section end -->
</div>
<!-- 2004/08/06 end -->



<hr class="hide">
<!-- 2004/08/07 start -->
<h2><a name="20040807" href="200408a.html#20040807">2004-08-07 (Sat)</a></h2>

<div class="entry1">
<h3><a name="200408071" title="200408071" href="200408a.html#200408071">■</a> 
<a href="http://jarp.jin.gr.jp/win32/">[Win32] Readline 5.0</a></h3>
<p>
Bash 3.0とともにリリースされたReadline 5.0をimportしよう。
</p>
<pre>
% cvs -d $repository import -m &quot;Import of Readline 5.0&quot; \
  readline eban readline-5_0
</pre>
<p>
としたら親切にも
</p>
<pre>
Use the following command to help the merge:

      cvs -d $repository checkout -j&lt;prev_rel_tag&gt; -jreadline-5_0 readline
</pre>
<p>
と言われたので、
</p>
<pre>
% cvs -d $repository co -j base -j readline-5_0 readline
</pre>
<p>
のようにcheckoutした。あとはconflictしたファイルを修正してcommit。
</p>
<!-- section end -->
</div>
<!-- 2004/08/07 end -->



<hr class="hide">
<!-- 2004/08/08 start -->
<h2><a name="20040808" href="200408a.html#20040808">2004-08-08 (Sun)</a></h2>

<div class="entry1">
<h3><a name="200408081" title="200408081" href="200408a.html#200408081">■</a> 
<a href="http://www.lickey.com/rubyfilter/">[Mail] RubyFilter</a></h3>
<p>
そろそろRubyFilterを使おうと思って、
<a href="http://raa.ruby-lang.org/">RAA</a>で検索してみると、URLが間違っている。

<a href="http://www.lickey.com/rubymail/">RubyMail</a>を指している。
</p>

<p>
ま、それはいいとして、

<a href="http://www.lickey.com/rubyfilter/rubyfilter/doc/classes/RFilter/DeliveryAgent.html#M000030">RFilter::DeliveryAgent#save</a>
にはMH形式で保存する方法ないようだ。
deliver_mhを作るか、#pipeでMHのコマンドを呼び出すか。
</p>

<!-- section end -->
</div>

<div class="entry0">
<h3><a name="200408082" title="200408082" href="200408a.html#200408082">■</a> 
[Quiz] PHB</h3>
<p>
最近
<a href="http://www.fujitv.co.jp/b_hp/iqsupli/">IQサプリ</a>にはまってる。
自分でも問題を考えてみた。さて?には何が入るか？
</p><blockquote class="cite"><p>
P, H, B, H, H, P, H, P, H, ?
</p></blockquote><p>
念のためぐぐってみるとなんと同じ問題を考えた人がいる。
なんか悔しい。
<!-- section end -->
</div>
<!-- 2004/08/08 end -->



<hr class="hide">
<!-- 2004/08/09 start -->
<h2><a name="20040809" href="200408a.html#20040809">2004-08-09 (Mon)</a></h2>

<div class="entry1">
<h3><a name="200408091" title="200408091" href="200408a.html#200408091">■</a> 
<a href="200408a.html#200408061">[Mail] 中身のないメール</a></h3>
<p>
どうやら
<a href="http://www.himadaka.com/mt/archives/000337.html">新手口</a>らしい。
今日も3通来てた。
</p>

<p>
via 
<a href="http://clip.myblog.jp/rank/click/">クリックランキング</a>
</p>

<!-- section end -->
</div>

<div class="entry0">
<h3><a name="200408092" title="200408092" href="200408a.html#200408092">■</a> 
[Mail] rdeliver.rbのテスト</h3>
<p>
とりあえず~/.procmailrcの最初のほうに
</p>
<pre>
:0 c
* $RUBYFILTER ?? yes
| /usr/local/bin/rdeliver.rb --log $HOME/.rdeliver.log
</pre>
<p>
を追加してみた。全部カーボンコピー扱い。
こうしておけば今の環境と併用できるはず。
先頭あたりにRUBYFILTER=yesと書いておけばrdeliver.rbが起動される。
</p>

<p>
rdeliver.rbに書いてあった通りに~/.rdeliverに最小の
</p>
<pre>
def main
  agent.save('inbox')
end
</pre>
<p>
を書いて実験。ここまでは問題なし。
</p>

<p>
つぎに
</p>
<pre>
def main
  agent.pipe('/usr/lib/mh/rcvsore +test')
end
</pre>
<p>
としてMH形式で保存させてみる。
</p>
<pre>
% scan +test
   1 2004-08-10 00:58   1379 |WATANABE H| test&lt;&lt;テスト。 
   2 2004-08-09 09:45   5835 |&quot;Abu M.Ses| business transaction.&lt;&lt;Greetings from
</pre>
<p>
いいようだ。って早速spamも来てるし。
</p>
<!-- section end -->
</div>
<!-- 2004/08/09 end -->



<hr class="hide">
<!-- 2004/08/10 start -->
<h2><a name="20040810" href="200408a.html#20040810">2004-08-10 (Tue)</a></h2>

<div class="entry1">
<h3><a name="200408101" title="200408101" href="200408a.html#200408101">■</a> 
<a href="http://raa.ruby-lang.org/project/bdb/">[Ruby] bdb 0.5.1</a></h3>
<p>
更新。
</p>

<!-- section end -->
</div>

<div class="entry0">
<h3><a name="200408102" title="200408102" href="200408a.html#200408102">■</a> 
[Mail] rdeliverとMH形式</h3>
<p>
RubyFilterというよりはrdeliverと言ったほうがいいかもと思う今日この頃。
agent.messageでメール全体を扱えるので
</p>
<pre>
open(&quot;/path/to/message&quot;, &quot;w&quot;) do |f|
  f.write agent.message
end
</pre>
<p>
という感じで保存できる。
そのファイル名はというとここで
<a href="200407b.html#200407111">例のmax_by</a>が出てくるわけだ(なげーよ)。
</p>
<pre>
require &quot;pathname&quot;

def main
  inbox = Pathname.new(&quot;~/Mail&quot;).expand_path.join(&quot;inbox&quot;)
  new_file = inbox.join(Dir.entries(inbox.untaint).max_by{|x| x.to_i}).to_s.succ
  agent.log(2, new_file)
  open(new_file.untaint, File::RDWR | File::CREAT | File::EXCL, 0600) do |f|
    f.write agent.message
  end
end
</pre>
<p>
でいいかと思ったら、なぜかlogに
</p><blockquote class="cite"><p>
Action: defer: finished without a final delivery
</p></blockquote><p>
と出てくる。なにかおまじないが必要なようだ。
saveを見てみるとraiseしなきゃいけないらしい。
<pre>
raise ::RFilter::DeliveryAgent::DeliverySuccess, &quot;saved to mbox #{new_file.dump}&quot;
new_file
</pre>
<p>
を最後に追加。これでいいみたい。
</p>

<p>
いやいやそんなことしなくてもagent.save(new_file.untaint)でいいじゃん。
pwdは$HOMEになるようなので、expand_pathもやめよう。
</p>
<pre>
def main
  inbox = &quot;Mail/inbox&quot;
  new_file = File.join(inbox, Dir.entries(inbox).max_by{|x| x.to_i}).succ
  agent.save(new_file.untaint)
end
</pre>

<!-- section end -->
</div>
<!-- 2004/08/10 end -->

<hr>
<div>
<a href="200407c.html">&lt;Prev(,)</a> | 
<a href="200408b.html">Next(.)&gt;</a> | 
<a href="index.html">Recent(/)&gt;&gt;</a>
| <a href="index.rdf">RDF</a>
</div>

<hr>
<!-- SiteSearch Google -->
<form method=GET action="http://www.google.co.jp/search">
<p>
<input type=text name=q size=31 maxlength=255 value="">
<input type=hidden name=hl value="ja">
<input type=hidden name=ie value="UTF-8">
<input type=submit name=btnG value="Google 検索">
<input type=hidden name=domains value="jarp.does.notwork.org"><br>
<input type=radio name=sitesearch value=""> WWW を検索
<input type=radio name=sitesearch value="jarp.does.notwork.org" checked> jarp.does.notwork.org を検索 <br>
</form>

<!-- nsmm v0.6.3.2(2005/08/18) -->

<address><a href="&#109;&#x61;&#x69;&#108;&#116;&#111;&#x3A;&#101;&#98;&#x61;&#110;&#64;&#x6F;&#x73;&#x2E;&#x72;&#105;&#109;&#46;&#x6F;&#x72;&#x2E;&#106;&#x70;">わたなべひろふみ</a><br>
Key fingerprint = C456 1350 085F A320 C6C8  8A36 0F15 9B2E EB12 3885<br>
      <a href="http://validator.w3.org/check?uri=referer"><img
          src="http://www.w3.org/Icons/valid-html401"
          alt="Valid HTML 4.01!" height="16" width="88"></a>

<script type="text/javascript" src="http://trackfeed.com/usr/aa7471e560.js"></script>
</address>

<script src="http://www.google-analytics.com/urchin.js" type="text/javascript">
</script>
<script type="text/javascript">
<!--
_uacct = "UA-101613-1";
urchinTracker();
// -->
</script>
<script src="title.js" type="text/javascript">
</script>
</body>
</html>

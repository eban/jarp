<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html lang="ja-JP">
<head>
<title>Just another Ruby porter, 2014-6-a</title>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta name="generator" content="nsmm v0.6.3.2(2005/08/18)">
<meta name="author" content="わたなべひろふみ">
<meta http-equiv="Content-Style-Type" content="text/css">
<META http-equiv="Content-Script-Type" content="text/javascript">
<link rel="stylesheet" href="../css/basic.css" type="text/css" media="all">
<link rel="shortcut icon" type="image/x-icon" href="../favicon.ico">
<link rel="icon" type="image/png" href="../favicon.png">
<link rel="alternate" type="application/rss+xml" title="RSS" href="https://jarp.does.notwork.org/jarp/diary/index.rdf">
<link rev="made" href="&#109;&#x61;&#x69;&#108;&#116;&#111;&#x3A;&#101;&#98;&#x61;&#110;&#64;&#x6F;&#x73;&#x2E;&#x72;&#105;&#109;&#46;&#x6F;&#x72;&#x2E;&#106;&#x70;">
<link rel="index" href="./">
<link rel="prev" href="201405c.html">
<link rel="next" href="201406b.html">

<link rel="stylesheet" type="text/css" href="https://google-code-prettify.googlecode.com/svn/trunk/src/prettify.css">
<script async type="text/javascript" src="https://google-code-prettify.googlecode.com/svn/trunk/src/prettify.js"></script>
<script type="text/javascript">
<!--       
$(document).ready(function() {
  prettyPrint();
});
-->
</script>
</head>
<body>
<div><h1><span>Just another Ruby porter,</span></h1></div>

<p>〜2014年6月上旬〜</p>
<hr>
<div>
<a href="201405c.html" accesskey=",">&lt;Older(,)</a> | 
<a href="201406b.html" accesskey=".">Newer(.)&gt;</a> | 
<a href="index.html" accesskey="/">Recent(/)&gt;&gt;</a>
| <a href="index.rdf">RDF</a>
</div>

<hr>

<!-- 2014/06/01 start -->
<h2><a name="20140601" href="201406a.html#20140601">2014-06-01 (Sun)</a></h2>

<div class="entry1">
<h3><a name="201406011" title="201406011" href="201406a.html#201406011">■</a> 
GNU parallelのいいところ</h3>
<p>
いきなりGNU parallelの罠にはまってしまったが、<br>
シェルを介すからこそ簡単にできることもある。<br>
たとえば
<a href="http://golf.shinh.org/p.rb?Ten+Count">Ten Count</a>は
</p>
<pre>
parallel seq {} $\[{}+9]
</pre>
<p>
でいいわけだ。xargsだとこんな感じにならざるを得ない。
</p>
<pre>
xargs -I@ zsh -c 'seq @ $[@+9]'
</pre>
<!-- section end -->
</div>
<!-- 2014/06/01 end -->



<hr class="hide">
<!-- 2014/06/02 start -->
<h2><a name="20140602" href="201406a.html#20140602">2014-06-02 (Mon)</a></h2>

<div class="entry1">
<h3><a name="201406021" title="201406021" href="201406a.html#201406021">■</a> 
5月のspam</h3>
<p>
900通ほど。なにしろ31日にspam bombがあったため。

</p>
<!-- section end -->
</div>

<div class="entry0">
<h3><a name="201406022" title="201406022" href="201406a.html#201406022">■</a> 
<a href="http://www.commandlinefu.com/commands/view/13432/determine-if-photos-have-been-rotated-to-portrait-orientation-instead-of-normal-landscape-orientation">Determine if photos have been rotated to portrait orientation instead of normal landscape orientation</a></h3>
<p>
横よりも縦のほうが長い画像を探すという話。
</p>
<pre>
% for i in *; do identify $i | awk  '{split($3,a,&quot;x&quot;); if (a[2]&gt;a[1]) print $1;}'; done
</pre>
<p>
identifyは-formatで好きな情報を選んで表示できるので、awkでsplitするよりは簡単になる。
</p>
<pre>
% identify bakeneko-eban-twitter-sleepy.png
bakeneko-eban-twitter-sleepy.png PNG 300x300 300x300+0+0 8-bit DirectClass 16.4KB 0.000u 0:00.000
% identify -format '%f %w %h' bakeneko-eban-twitter-sleepy.png
bakeneko-eban-twitter-sleepy.png 300 300<br>
% for i in *; do identify -format '%f %w %h' $i | awk  '$2&lt;$3{print $1}'; done
</pre>
<p>
さらにワイルドカード処理をconvertに任せてしまえばforは要らない。この場合は改行が必要。
</p>
<pre>
% identify -format '%f %w %h\n' '*' | awk  '$2&lt;$3{print $1}'
</pre>
<p>
アニメーションGIFの場合を考えると最初の1枚だけにしないとうっとうしいので[0]をつけたほうがいい。
</p>
<pre>
% identify -format '%f %w %h\n' '*[0]' | awk  '$2&lt;$3{print $1}'
</pre>

<!-- section end -->
</div>
<!-- 2014/06/02 end -->



<hr class="hide">
<!-- 2014/06/03 start -->
<h2><a name="20140603" href="201406a.html#20140603">2014-06-03 (Tue)</a></h2>

<div class="entry1">
<h3><a name="201406031" title="201406031" href="201406a.html#201406031">■</a> 
Ruby関連ML再開</h3>
<p>
月曜日の朝に再開。一応spam bombに対しては策を講じた。<br>
30分でまた攻撃も再開。対策もうまくいって全部ブロック。<br>
652通であきらめたようで、その後はぴたっと来なくなった。
</p>
<!-- section end -->
</div>
<!-- 2014/06/03 end -->



<hr class="hide">
<!-- 2014/06/04 start -->
<h2><a name="20140604" href="201406a.html#20140604">2014-06-04 (Wed)</a></h2>

<div class="entry1">
<h3><a name="201406041" title="201406041" href="201406a.html#201406041">■</a> 
aptコマンド</h3>
<p>
Ubuntu 14.04から
<a href="http://gihyo.jp/admin/serial/01/ubuntu-recipe/0327?page=2">aptコマンド</a>が追加されたというので
<a href="https://jarp.does.notwork.org/jarp/diary/200909b.html#200909151">例のあれ</a>をやってみた。
</p>
<pre>
% apt moo
                 (__)
                 (oo)
           /------\/
          / |    ||
         *  /\---/\
            ~~   ~<br>
...&quot;Have you mooed today?&quot;...
% apt moo moo
                 (__)
         _______~(..)<br>
           ,----\(oo)
          /|____|,'
         * /&quot;\ /\
           ~ ~ ~<br>
...&quot;Have you mooed today?&quot;...
% apt moo moo moo
                     \_/
   m00h  (__)       -(_)-
      \  ~Oo~___     / \
         (..)  |\
___________|_|_|_____________
...&quot;Have you mooed today?&quot;...
% apt moo moo moo moo
                 (__)
                 (oo)
           /------\/
          / |    ||
         *  /\---/\
            ~~   ~<br>
...&quot;Have you mooed today?&quot;...
% apt moo moo moo moo
                 (__)
         _______~(..)<br>
           ,----\(oo)
          /|____|,'
         * /&quot;\ /\
           ~ ~ ~<br>
...&quot;Have you mooed today?&quot;...
% apt moo moo moo moo
                     \_/
   m00h  (__)       -(_)-
      \  ~Oo~___     / \
         (..)  |\
___________|_|_|_____________
...&quot;Have you mooed today?&quot;...
</pre>
<p>
mooが3つになるとランダムに表示されるようだ。<br>
4月1日はfaketimeの出番だ。
</p>
<pre>
% faketime 4/1 apt moo
               _     _
              (_\___( \,
                )___   _  Have you smashed some milk today?
               /( (_)-(_)    /
    ,---------'         \_
  //(  ',__,'      \  (' ')
 //  )              '----'
 '' ; \     .--.  ,/
    | )',_,'----( ;
    ||| '''     '||
% faketime 4/1 apt moo moo
               _     _
              (_\___( \,
                )___   _  Have you smashed some milk today?
               /( (_)-(_)    /
    ,---------'         \_
  //(  ',__,'      \  (' ')
 //  )              '----'
 '' ; \     .--.  ,/
    | )',_,'----( ;
    ||| '''     '||
</pre>
<p>
こっちは1種類だけだ。
</p>
<!-- section end -->
</div>
<!-- 2014/06/04 end -->



<hr class="hide">
<!-- 2014/06/05 start -->
<h2><a name="20140605" href="201406a.html#20140605">2014-06-05 (Thu)</a></h2>

<div class="entry1">
<h3><a name="201406051" title="201406051" href="201406a.html#201406051">■</a> 
<a href="http://www.windowtabs.com/">WindowTabs</a></h3>
<p>
minttyをタブ化する目的で入れた。
Free版は3つまでタブ化可能。<br>
それを越えると3個ごとのグループが作られる。<br>
minttyはなんだかんだで5個ぐらい開いてるかな。<br>
tmuxとかscreenを使えばいいんだが、<br>
ネストするのいやで大元はタブにするのが好み。
</p>
<!-- section end -->
</div>
<!-- 2014/06/05 end -->



<hr class="hide">
<!-- 2014/06/06 start -->
<h2><a name="20140606" href="201406a.html#20140606">2014-06-06 (Fri)</a></h2>

<div class="entry1">
<h3><a name="201406061" title="201406061" href="201406a.html#201406061">■</a> 
なぜか100%にならない</h3>
<p>
例の東京アメッシュで家を中心に20km圏内で雨が降ってる範囲の割合計算してるんだけど、<br>
なぜか100%にならないことに気づいた。
どう見ても色がついてるので変だなと思ったら、blackなんてものが。<br>
そんな色どこにも見当たらない。<br>
拡大してみたら、そうか影か。<br>
そんなエフェクトが。<br>
これを足したらちゃんと100%になった。
</p>
<!-- section end -->
</div>
<!-- 2014/06/06 end -->



<hr class="hide">
<!-- 2014/06/07 start -->
<h2><a name="20140607" href="201406a.html#20140607">2014-06-07 (Sat)</a></h2>

<div class="entry1">
<h3><a name="201406071" title="201406071" href="201406a.html#201406071">■</a> 
CTRL+TAB</h3>
<p>
WindowTabsとDexpotの相性が悪い。<br>
せっかくタブ化してもDexpotで仮想デスクトップを切り替えるとタブ化が解除されてしまう。<br>
とはいえ全部重なっているのでCTRL+TABで切り替えるとうまい具合にminttyだけで巡回する。<br>
つまりまるでタブを切り替えるのと同じ状態になる。タブはないけど。<br>
これは適当に重ねとけばWindowTabsがなくてもいいと言える。<br>
CTRL+TABはブラウザでもお馴染の機能で覚えやすい。
</p>
<!-- section end -->
</div>
<!-- 2014/06/07 end -->



<hr class="hide">
<!-- 2014/06/08 start -->
<h2><a name="20140608" href="201406a.html#20140608">2014-06-08 (Sun)</a></h2>

<div class="entry1">
<h3><a name="201406081" title="201406081" href="201406a.html#201406081">■</a> 
アニメーションGIFの画像をいじる</h3>
<p>
すでにあるアニメーションGIFの最初の画像を削除して新たに画像を加えるにはどうしたらいいか。<br>
まずはわかりやすいように0,1,2と埋め込んだアニメーションGIFを作る。
</p>
<pre>
% convert -loop 0 -delay 100 -size 250x250 -pointsize 200 -gravity center \
  \( xc:white -draw 'text 0,0 &quot;0&quot;' \) \
  \( xc:white -draw 'text 0,0 &quot;1&quot;' \) \
  \( xc:white -draw 'text 0,0 &quot;2&quot;' \) \
  012.gif
</pre>
<p>
<img src="../images/012.gif" alt="">
</p>
<p>
続いてこの画像をいじる。最初の画像は-delete 0で消せる。その後で3を追加する。
</p>
<pre>
% convert -loop 0 -delay 100 012.gif -size 250x250 -pointsize 200 -gravity center \
  -delete 0 \
  \( xc:white -draw 'text 0,0 &quot;3&quot;' \) \
  123.gif
</pre>
<p>
<img src="../images/123.gif" alt="">
</p>
<p>
結構あっさりできた。元画像を残しておかなくてもアニメーションGIF画像だけあればできるわけだ。
</p>
<!-- section end -->
</div>
<!-- 2014/06/08 end -->



<hr class="hide">
<!-- 2014/06/09 start -->
<h2><a name="20140609" href="201406a.html#20140609">2014-06-09 (Mon)</a></h2>

<div class="entry1">
<h3><a name="201406091" title="201406091" href="201406a.html#201406091">■</a> 
アニメーションGIFの画像をいじるのつづき</h3>
<p>
消したり最後に追加したりするほかに、swapで入れ替えたり、insertで挿入することも可能。<br>
cloneはいままでもちょくちょく使っているし、これだけできれば任意の操作が可能だな。
</p>
<!-- section end -->
</div>
<!-- 2014/06/09 end -->



<hr class="hide">
<!-- 2014/06/10 start -->
<h2><a name="20140610" href="201406a.html#20140610">2014-06-10 (Tue)</a></h2>

<div class="entry1">
<h3><a name="201406101" title="201406101" href="201406a.html#201406101">■</a> 
文字を回転させて重ねるときれいな模様になる(改)</h3>
<p>
<a href="https://jarp.does.notwork.org/jarp/diary/201405c.html#201405241">以前の方法</a>だと無駄に長くなるのでちょっといじってみた。<br>
重ねるときは-compose multiplyでよさげだ。
</p>
<pre>
% convert -size 200x200 xc:white -font Courier-New-Regular -pointsize 100 -gravity center \
  -draw 'text 0,-30 &quot;%&quot;' +repage 0000.png
% convert -gravity center 0000.png \( +clone -rotate 180 \) -compose multiply -composite 1800.png
% convert -gravity center 1800.png \( +clone -rotate 90 \) -compose multiply -composite 0900.png
% convert -gravity center 0900.png \( +clone -rotate 45 \) -compose multiply -composite 0450.png
% convert -gravity center 0450.png \( +clone -rotate 22.5 \) -compose multiply -composite 0225.png
</pre>
<p>
<img src="../images/0000.png" alt="">
<img src="../images/1800.png" alt="">
<img src="../images/0900.png" alt="">
<img src="../images/0450.png" alt="">
<img src="../images/0225.png" alt="">
</p>
<p>
背景の白を透明にして重ねると境界のあたりがかなり残念な状態に。<br>
モノクロに見えるけど実際はアンチエイリアスがかかっているので境界はグレーになっている。<br>
できあがりはこんな感じ。
</p>
<p>
<img src="../images/0225z.png" alt="">
</p>
<p>
これはこれで味があっていいのかもしれないが。
</p>
<!-- section end -->
</div>
<!-- 2014/06/10 end -->

<hr>
<div>
<a href="201405c.html">&lt;Older(,)</a> | 
<a href="201406b.html">Newer(.)&gt;</a> | 
<a href="index.html">Recent(/)&gt;&gt;</a>
| <a href="index.rdf">RDF</a>
</div>

<hr>
<!-- SiteSearch Google -->
<form method=GET action="https://www.google.co.jp/search">
<p>
<input type=text name=q size=31 maxlength=255 value="">
<input type=hidden name=hl value="ja">
<input type=hidden name=ie value="UTF-8">
<input type=submit name=btnG value="Google 検索">
<input type=hidden name=domains value="jarp.does.notwork.org"><br>
<input type=radio name=sitesearch value=""> WWW を検索
<input type=radio name=sitesearch value="jarp.does.notwork.org" checked> jarp.does.notwork.org を検索 <br>
</form>

<!-- nsmm v0.6.3.2(2005/08/18) -->

<address><a href="&#109;&#x61;&#x69;&#108;&#116;&#111;&#x3A;&#101;&#98;&#x61;&#110;&#64;&#x6F;&#x73;&#x2E;&#x72;&#105;&#109;&#46;&#x6F;&#x72;&#x2E;&#106;&#x70;">わたなべひろふみ</a><br>
Key fingerprint = C456 1350 085F A320 C6C8  8A36 0F15 9B2E EB12 3885<br>
      <a href="http://validator.w3.org/check?uri=referer"><img
          src="http://www.w3.org/Icons/valid-html401"
          alt="Valid HTML 4.01!" height="16" width="88"></a>

<script type="text/javascript" src="http://trackfeed.com/usr/aa7471e560.js"></script>
</address>

<script src="https://www.google-analytics.com/urchin.js" type="text/javascript">
</script>
<script type="text/javascript">
<!--
_uacct = "UA-101613-1";
urchinTracker();
// -->
</script>
<script src="title.js" type="text/javascript">
</script>
</body>
</html>

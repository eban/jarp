<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html lang="ja-JP">
<head>
<title>Just another Ruby porter, 2010-11-b</title>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta name="generator" content="nsmm v0.6.3.2(2005/08/18)">
<meta name="author" content="わたなべひろふみ">
<meta http-equiv="Content-Style-Type" content="text/css">
<META http-equiv="Content-Script-Type" content="text/javascript">
<link rel="stylesheet" href="../css/basic.css" type="text/css" media="all">
<link rel="shortcut icon" type="image/x-icon" href="../favicon.ico">
<link rel="icon" type="image/png" href="../favicon.png">
<link rel="alternate" type="application/rss+xml" title="RSS" href="https://jarp.does.notwork.org/jarp/diary/index.rdf">
<link rev="made" href="&#109;&#x61;&#x69;&#108;&#116;&#111;&#x3A;&#101;&#98;&#x61;&#110;&#64;&#x6F;&#x73;&#x2E;&#x72;&#105;&#109;&#46;&#x6F;&#x72;&#x2E;&#106;&#x70;">
<link rel="index" href="./">
<link rel="prev" href="201011a.html">
<link rel="next" href="201011c.html">

</head>
<body>
<div><h1><span>Just another Ruby porter,</span></h1></div>

<p>〜2010年11月中旬〜</p>
<hr>
<div>
<a href="201011a.html" accesskey=",">&lt;Prev(,)</a> | 
<a href="201011c.html" accesskey=".">Next(.)&gt;</a> | 
<a href="index.html" accesskey="/">Recent(/)&gt;&gt;</a>
| <a href="index.rdf">RDF</a>
</div>

<hr>

<!-- 2010/11/11 start -->
<h2><a name="20101111" href="201011b.html#20101111">2010-11-11 (Thu)</a></h2>

<div class="entry1">
<h3><a name="201011111" title="201011111" href="201011b.html#201011111">■</a> 
[Ruby] makeのコマンドライン表示を隠す</h3>
<p>
なつかしい
<a href="200605b.html#200605121">アイデア</a>が採用された。
</p>
<pre>
% make miniruby
compiling ../ruby/trunk/main.c
compiling ../ruby/trunk/dmydln.c
compiling ../ruby/trunk/dmyencoding.c
compiling ../ruby/trunk/version.c
compiling ../ruby/trunk/dmyversion.c
compiling miniprelude.c
compiling ../ruby/trunk/array.c
compiling ../ruby/trunk/bignum.c
compiling ../ruby/trunk/class.c
compiling ../ruby/trunk/compar.c
compiling ../ruby/trunk/complex.c
compiling ../ruby/trunk/dir.c
compiling ../ruby/trunk/dln_find.c
compiling ../ruby/trunk/enum.c
compiling ../ruby/trunk/enumerator.c
compiling ../ruby/trunk/error.c
compiling ../ruby/trunk/eval.c
&lt;以下省略&gt;
</pre>
<p>
のような表示になる。
</p>
<p>
V=1で今までのように表示する。
</p>
<pre>
% make V=1 miniruby
\
	gcc -O3 -ggdb -Wextra -Wno-unused-parameter -Wno-parentheses -Wpointer-arith -Wwrite-strings -Wno-missing-field-initializers -Wno-long-long -include ruby/config.h -include ruby/missing.h -fvisibility=hidden -DRUBY_EXPORT   -I. -I.ext/include/x86_64-linux -I../ruby/trunk/include -I../ruby/trunk -o main.o -c ../ruby/trunk/main.c
\
	gcc -O3 -ggdb -Wextra -Wno-unused-parameter -Wno-parentheses -Wpointer-arith -Wwrite-strings -Wno-missing-field-initializers -Wno-long-long -include ruby/config.h -include ruby/missing.h -fvisibility=hidden -DRUBY_EXPORT   -I. -I.ext/include/x86_64-linux -I../ruby/trunk/include -I../ruby/trunk -o dmydln.o -c ../ruby/trunk/dmydln.c
&lt;以下省略&gt;
</pre>
<p>
\とかインデントとかちょっとうるさい感じかな。
</p>
<!-- section end -->
</div>
<!-- 2010/11/11 end -->



<hr class="hide">
<!-- 2010/11/12 start -->
<h2><a name="20101112" href="201011b.html#20101112">2010-11-12 (Fri)</a></h2>

<div class="entry1">
<h3><a name="201011121" title="201011121" href="201011b.html#201011121">■</a> 
<a href="http://golf.shinh.org/p.rb?weekday+names">[Golf] weekday names</a></h3>
<p>
なぜか各曜日の後に空白が1個。これが結構曲者。結構奥が深い。
</p>
<!-- section end -->
</div>
<!-- 2010/11/12 end -->



<hr class="hide">
<!-- 2010/11/13 start -->
<h2><a name="20101113" href="201011b.html#20101113">2010-11-13 (Sat)</a></h2>

<div class="entry1">
<h3><a name="201011131" title="201011131" href="201011b.html#201011131">■</a> 
[Net] 瞬間停電でネットワークの調子がよくなった</h3>
<p>
PCが再起動されてて変だと思ったら、今朝瞬間停電があった模様。<br>
なぜかここ数ヶ月タイムアウト頻発していたネットワークの調子がよくなった。<br>
でもPCはつい2,3日前にも再起動したのでこれが原因ではない。<br>
そうか、ルータかと思い至る。交換したやつはだめだめだな、SBよ。<br>
まあ、でもルータをリセットすればいいとわかっただけもうけものと考えよう。
</p>
<!-- section end -->
</div>
<!-- 2010/11/13 end -->



<hr class="hide">
<!-- 2010/11/14 start -->
<h2><a name="20101114" href="201011b.html#20101114">2010-11-14 (Sun)</a></h2>

<div class="entry1">
<h3><a name="201011141" title="201011141" href="201011b.html#201011141">■</a> 
<a href="201010c.html#201010251">[crontab] fri/2の件</a></h3>
<p>
嘘だった。fri/2としても1,3,5週目の金曜日にはならない。<br>
そもそも曜日のところで*/2としてもsun,tue,thu,satという意味なので隔週どころじゃない。<br>
でしかもfri/2としてもfriと指定したのと同じで/2は無視される。<br>
無視されるというか/はrangeかlistにしか効かない。
</p>
<p>
なんか自分に都合よく解釈していたようで。
</p>
<!-- section end -->
</div>
<!-- 2010/11/14 end -->



<hr class="hide">
<!-- 2010/11/15 start -->
<h2><a name="20101115" href="201011b.html#20101115">2010-11-15 (Mon)</a></h2>

<div class="entry1">
<h3><a name="201011151" title="201011151" href="201011b.html#201011151">■</a> 
<a href="http://golf.shinh.org/p.rb?Bigger+power+of+two#Ruby">[Golf] Bigger power+of two</a></h3>
<p>
変遷。最初は素直に。38Bだが、これ以上縮みそうもない。
</p>
<pre>
$&lt;.map{|x|i=1;0while x.to_i&gt;=i*=2;p i}
</pre>
<p>
次にwikipediaかどこかに載ってたCでビット操作する方法をRubyへ移植。<br>
要するに2進数で考えてbitの0を全部1にして+1すればいい。
</p>
<pre>
$&lt;.map{|x|p 1+x.to_i.to_s(2).tr(&quot;0&quot;,&quot;1&quot;).to_i(2)}
$&lt;.map{|x|p 1+(&quot;%b&quot;%x.to_i).tr(&quot;0&quot;,&quot;1&quot;).to_i(2)}
$&lt;.map{|x|p 1+(&quot;%b&quot;%x).tr(&quot;0&quot;,&quot;1&quot;).to_i(2)}
$&lt;.map{|x|p 1&lt;&lt;(&quot;%b&quot;%x).tr(&quot;0&quot;,&quot;1&quot;).size}
$&lt;.map{|x|p 2&lt;&lt;Math.log(x)/0.693}
$&lt;.map{|x|p 1&lt;&lt;(&quot;%b&quot;%x).size}
</pre>
<p>
29Bになった。途中でlog2で考えればいいと気づきそっち方面へ。<br>
28Bは/$/を使うんだろうなというのまでは気づいたが、.&lt;&lt;とのからみまでは思い付かなかった。
</p>
<p>
1.9だとMath::log2が存在するので
</p>
<pre>
$&lt;.map{|x|p 2&lt;&lt;Math.log2(x.to_i)}
</pre>
<p>
でいける。って、1.8のMath::logはなんで文字列を受け付けるんだ？
</p>
<!-- section end -->
</div>
<!-- 2010/11/15 end -->



<hr class="hide">
<!-- 2010/11/16 start -->
<h2><a name="20101116" href="201011b.html#20101116">2010-11-16 (Tue)</a></h2>

<div class="entry1">
<h3><a name="201011161" title="201011161" href="201011b.html#201011161">■</a> 
<a href="http://freshmeat.net/projects/lrzip">[Soft] LONG RANGE ZIP 0.530</a></h3>
<blockquote><dl>
<dt>
Description:
<dd>
LRZIP is a compression program that can achieve very high compression
ratios and speed when used with large files using unlimited sized
compression windows. It uses the combined compression algorithms of zpaq
and lzma for maximum compression, lzo for maximum speed, and the long
range redundancy reduction of rzip. It is designed to scale with
increases with RAM size, improving compression further. A choice of
either size or speed optimizations allows for either better compression
than even lzma can provide, or better speed than gzip, but with bzip2
sized compression levels.
</dl></blockquote>
<!-- section end -->
</div>
<!-- 2010/11/16 end -->



<hr class="hide">
<!-- 2010/11/17 start -->
<h2><a name="20101117" href="201011b.html#20101117">2010-11-17 (Wed)</a></h2>

<div class="entry1">
<h3><a name="201011171" title="201011171" href="201011b.html#201011171">■</a> 
<a href="http://golf.shinh.org/p.rb?electronic+dice">[Golf] electronic dice</a></h3>
<p>
Sorobanとか最近この手の問題が多いな。まずはバイナリに逃げずに解いてみる。
</p>
<!-- section end -->
</div>
<!-- 2010/11/17 end -->



<hr class="hide">
<!-- 2010/11/18 start -->
<h2><a name="20101118" href="201011b.html#20101118">2010-11-18 (Thu)</a></h2>

<div class="entry1">
<h3><a name="201011181" title="201011181" href="201011b.html#201011181">■</a> 
[Shell] bashとzshの配列</h3>
<p>
まさかこんなところが違うとは思わなかった。
</p>
<pre>
% bash -c 'a=(0 1 2); echo ${a[1]}'
1
% zsh -c 'a=(0 1 2); echo ${a[1]}'
0
</pre>
<p>
ゴルフ的には-1の有無で2B違う。それ以前にzshでは$a[1]でもいいというのがあるが。
</p>
<!-- section end -->
</div>
<!-- 2010/11/18 end -->



<hr class="hide">
<!-- 2010/11/19 start -->
<h2><a name="20101119" href="201011b.html#20101119">2010-11-19 (Fri)</a></h2>

<div class="entry1">
<h3><a name="201011191" title="201011191" href="201011b.html#201011191">■</a> 
<a href="http://golf.shinh.org/p.rb?weekday+names">[Golf] weekday names</a></h3>
<p>
strftimeに気づけばあとはどこから1週間表示するかだけだけど、<br>
<a href="http://golf.shinh.org/reveal.rb?weekday+names/yvl_1289557272&amp;rb">yvlさんの解</a>は一瞬悩んだ。
</p>
<pre>
loop{puts Time.gm($$+$.+=12).strftime'%A '}
</pre>
<p>
ゴルフ場では
<a href="http://golf.shinh.org/setpid.html">pidを自由に設定できる</a>という、とんでもない機能があるから成立する解ではある。<br>
たぶんオーバーフローするぎりぎりのあたりにpidを設定すれば、<br>
7回表示してout of rangeで落ちるんだと思う。<br>
わかりやすく直近であてはまる年を例に挙げると
</p>
<pre>
7.times{puts Time.gm(2005+$.+=12).strftime'%A '}
</pre>
<p>
となる。$.はスクリプトを読み込んだときに1行しかないので1になる。<br>
最初はTime.gm(2018)となるが、これは2018-01-01を意味する。
</p>
<pre>
% cal 1 2018
    January 2018
Su Mo Tu We Th Fr Sa
    1  2  3  4  5  6
 7  8  9 10 11 12 13
14 15 16 17 18 19 20
21 22 23 24 25 26 27
28 29 30 31

</pre>
<p>
つまり2018, 2030, 2042, ...のように1月1日の曜日を12年ごとに順に表示すると、<br>
うまいこと月曜日から日曜日までそろうことになる。<br>
日付をインクリメントするんじゃなくて年を使うというのはすごい発想だ。
</p>
<p>
1.9だと$.の初期値が0なのはまあいいとして、Timeがout of rangeにならないのでこの手は使えない。
</p>
<!-- section end -->
</div>
<!-- 2010/11/19 end -->



<hr class="hide">
<!-- 2010/11/20 start -->
<h2><a name="20101120" href="201011b.html#20101120">2010-11-20 (Sat)</a></h2>

<div class="entry1">
<h3><a name="201011201" title="201011201" href="201011b.html#201011201">■</a> 
<a href="http://golf.shinh.org/p.rb?weekday+names">[Golf] weekday names</a></h3>
<p>
今日も凝りもせずにweekday names。Bash編:
</p>
<pre>
printf &quot;%s
&quot; {Mon,Tues,Wednes,Thurs,Fri,Satur,Sun}day

printf &quot;%sday
&quot; Mon Tues Wednes Thurs Fri Satur Sun

for i in {4..10}
{
date -d1/$i +%A\
}

for i in {1..7}
{
date -d2/$i +%A\
}

seq -f&quot;date -d2/%g +%%A\ &quot; 7|sh
</pre>
<p>
printf(1)のフォーマット文字列は引数のほうが多い場合は必要な分だけ再利用される。<br>
2/1は2月1日を意味するので今年限定の解となる。
</p>
<pre>
% cal 2 2010
   February 2010
Su Mo Tu We Th Fr Sa
    1  2  3  4  5  6
 7  8  9 10 11 12 13
14 15 16 17 18 19 20
21 22 23 24 25 26 27
28

</pre>
<p>
これ以上は無理かと思ったら1B更新された。となると{1..7}しかないと思ってevalを思いついた。
</p>
<pre>
eval &quot;date +%A\  -d2/&quot;{1..7}\;
</pre>
<p>
それにしても、
<a href="http://golf.shinh.org/p.rb?weekday+names#AWK">awkの解</a>は全然違うのにサイズが同じなのは笑った。
</p>
<!-- section end -->
</div>
<!-- 2010/11/20 end -->

<hr>
<div>
<a href="201011a.html">&lt;Prev(,)</a> | 
<a href="201011c.html">Next(.)&gt;</a> | 
<a href="index.html">Recent(/)&gt;&gt;</a>
| <a href="index.rdf">RDF</a>
</div>

<hr>
<!-- SiteSearch Google -->
<form method=GET action="https://www.google.co.jp/search">
<p>
<input type=text name=q size=31 maxlength=255 value="">
<input type=hidden name=hl value="ja">
<input type=hidden name=ie value="UTF-8">
<input type=submit name=btnG value="Google 検索">
<input type=hidden name=domains value="jarp.does.notwork.org"><br>
<input type=radio name=sitesearch value=""> WWW を検索
<input type=radio name=sitesearch value="jarp.does.notwork.org" checked> jarp.does.notwork.org を検索 <br>
</form>

<!-- nsmm v0.6.3.2(2005/08/18) -->

<address><a href="&#109;&#x61;&#x69;&#108;&#116;&#111;&#x3A;&#101;&#98;&#x61;&#110;&#64;&#x6F;&#x73;&#x2E;&#x72;&#105;&#109;&#46;&#x6F;&#x72;&#x2E;&#106;&#x70;">わたなべひろふみ</a><br>
Key fingerprint = C456 1350 085F A320 C6C8  8A36 0F15 9B2E EB12 3885<br>
      <a href="http://validator.w3.org/check?uri=referer"><img
          src="http://www.w3.org/Icons/valid-html401"
          alt="Valid HTML 4.01!" height="16" width="88"></a>

<script type="text/javascript" src="http://trackfeed.com/usr/aa7471e560.js"></script>
</address>

<script src="https://www.google-analytics.com/urchin.js" type="text/javascript">
</script>
<script type="text/javascript">
<!--
_uacct = "UA-101613-1";
urchinTracker();
// -->
</script>
<script src="title.js" type="text/javascript">
</script>
</body>
</html>

<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html lang="ja-JP">
<head>
<title>Just another Ruby porter, 2012-4-b</title>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta name="generator" content="nsmm v0.6.3.2(2005/08/18)">
<meta name="author" content="わたなべひろふみ">
<meta http-equiv="Content-Style-Type" content="text/css">
<META http-equiv="Content-Script-Type" content="text/javascript">
<link rel="stylesheet" href="../css/basic.css" type="text/css" media="all">
<link rel="shortcut icon" type="image/x-icon" href="../favicon.ico">
<link rel="icon" type="image/png" href="../favicon.png">
<link rel="alternate" type="application/rss+xml" title="RSS" href="https://jarp.does.notwork.org/jarp/diary/index.rdf">
<link rev="made" href="&#109;&#x61;&#x69;&#108;&#116;&#111;&#x3A;&#101;&#98;&#x61;&#110;&#64;&#x6F;&#x73;&#x2E;&#x72;&#105;&#109;&#46;&#x6F;&#x72;&#x2E;&#106;&#x70;">
<link rel="index" href="./">
<link rel="prev" href="201204a.html">
<link rel="next" href="201204c.html">

<link rel="stylesheet" type="text/css" href="http://google-code-prettify.googlecode.com/svn/trunk/src/prettify.css">
<script async type="text/javascript" src="http://google-code-prettify.googlecode.com/svn/trunk/src/prettify.js"></script>
<script type="text/javascript">
<!--       
$(document).ready(function() {
  prettyPrint();
});
-->
</script>
</head>
<body>
<div><h1><span>Just another Ruby porter,</span></h1></div>

<p>〜2012年4月中旬〜</p>
<hr>
<div>
<a href="201204a.html" accesskey=",">&lt;Older(,)</a> | 
<a href="201204c.html" accesskey=".">Newer(.)&gt;</a> | 
<a href="index.html" accesskey="/">Recent(/)&gt;&gt;</a>
| <a href="index.rdf">RDF</a>
</div>

<hr>

<!-- 2012/04/11 start -->
<h2><a name="20120411" href="201204b.html#20120411">2012-04-11 (Wed)</a></h2>

<div class="entry1">
<h3><a name="201204111" title="201204111" href="201204b.html#201204111">■</a> 
<a href="http://cmus.sourceforge.net/#features">cmus</a></h3>
<p>
curses-baseの音楽プレーヤー。vi-likeなキーバインド。<br>
mp4ファイルもmp3とかに変換しなくても音楽ファイルとして再生できるところはポイント高い。
</p>
<!-- section end -->
</div>
<!-- 2012/04/11 end -->



<hr class="hide">
<!-- 2012/04/12 start -->
<h2><a name="20120412" href="201204b.html#20120412">2012-04-12 (Thu)</a></h2>

<div class="entry1">
<h3><a name="201204121" title="201204121" href="201204b.html#201204121">■</a> 
cmusのいやなところ</h3>
<p>
端末のタイトルを書き換える。<br>
曲名を表示するのはまあいいんだけど、cmusを終了すると&quot;cmus v2.4.2&quot;と表示したままになる。<br>
そんな置き土産されても。gnome-terminalがcmus v2.4.2だらけになってるじゃないか。<br>
あちこちで起動しなきゃいい話ではあるが。
</p>
<!-- section end -->
</div>
<!-- 2012/04/12 end -->



<hr class="hide">
<!-- 2012/04/13 start -->
<h2><a name="20120413" href="201204b.html#20120413">2012-04-13 (Fri)</a></h2>

<div class="entry1">
<h3><a name="201204131" title="201204131" href="201204b.html#201204131">■</a> 
端末のタイトルを書き換える</h3>
<p>
tput(1)でできるかと調べてみると意外にもよくわからない。<br>
terminfo(5)にはstatus lineについては書いてあるが、titleで検索してもヒットせず。<br>
自分でprintf &quot;\e]0;タイトル\007&quot;するしかないのかな。
</p>
<!-- section end -->
</div>
<!-- 2012/04/13 end -->



<hr class="hide">
<!-- 2012/04/14 start -->
<h2><a name="20120414" href="201204b.html#20120414">2012-04-14 (Sat)</a></h2>

<div class="entry1">
<h3><a name="201204141" title="201204141" href="201204b.html#201204141">■</a> 
PROMPTに端末のタイトル設定を仕込む</h3>
<p>
zshなのでprecmdとかあるがコマンドを実行するよりはプロンプトで出させちゃったほうがよさげ。<br>
というわけでPS1の先頭に&quot;\e]0;%3~\7&quot;を追加した。<br>
%3~はPWDなんだけど最後の3レベルだけという意味。<br>
全部表示するとうっとうしいし、プロンプトもそんな感じで&quot;%m:%2~ %# &quot;としてるので。
</p>
<!-- section end -->
</div>
<!-- 2012/04/14 end -->



<hr class="hide">
<!-- 2012/04/15 start -->
<h2><a name="20120415" href="201204b.html#20120415">2012-04-15 (Sun)</a></h2>

<div class="entry1">
<h3><a name="201204151" title="201204151" href="201204b.html#201204151">■</a> 
カレントのファイルを1階層下のディレクトリに移動する</h3>
<p>
<a href="http://d.hatena.ne.jp/tyru/20120414/except_glob">twitterで話題になっていた話。</a>一時的にdot dirを作るという方法もある。
</p>
<pre>
% ls
a  b  c
% mkdir .dir
% mv * .dir
% mv .dir dir
</pre>
<p>
findとかzshの~とかパイプで組み合わせる場合でも事前にechoさせてみたりして確認するので、<br>
あまり複雑にするよりはいいんじゃないかな。
</p>
<!-- section end -->
</div>
<!-- 2012/04/15 end -->



<hr class="hide">
<!-- 2012/04/16 start -->
<h2><a name="20120416" href="201204b.html#20120416">2012-04-16 (Mon)</a></h2>

<div class="entry1">
<h3><a name="201204161" title="201204161" href="201204b.html#201204161">■</a> 
Firefoxのロケーションバーをクリックしたら選択した状態にする</h3>
<p>
実はこれWindows版とLinux版の違いだったりするんだけど、Linux版は選択にはならない。<br>
だいたいあそこをクリックするときはコピペするときなので、<br>
デフォルトとしてはWindows版のような挙動がいいんだよねえ。<br>
about:configしてそれらしい設定を探してみたら browser.urlbar.clickSelectsAll という、<br>
もう正にこれしかないという名前が見つかった。<br>
falseだったのでtrueしたらいけた。<br>
これでURLをクリックするだけでコピーされるようになった。地味に便利だ。
</p>
<!-- section end -->
</div>
<!-- 2012/04/16 end -->



<hr class="hide">
<!-- 2012/04/17 start -->
<h2><a name="20120417" href="201204b.html#20120417">2012-04-17 (Tue)</a></h2>

<div class="entry1">
<h3><a name="201204171" title="201204171" href="201204b.html#201204171">■</a> 
zshのプロンプトにエスケープシーケンスを仕込むときの注意</h3>
<p>
タイトル表示等カーソルが動かないエスケープシーケンスがPROMPTに含まれていると、<br>
その分の文字数だけずれるときがある。C-rするとなぜか右に飛ぶようになって変だなと思ったら、<br>
そういうことだった。<br>
zshだとその回りを%{と%}で囲めばいいようで。これで解決。
</p>
<p>
ああ、そういえばUbuntuのbashだと最初からタイトルがPWD的なものを表示するようになってるね。<br>
これも後で調べよう。
</p>
<!-- section end -->
</div>
<!-- 2012/04/17 end -->



<hr class="hide">
<!-- 2012/04/18 start -->
<h2><a name="20120418" href="201204b.html#20120418">2012-04-18 (Wed)</a></h2>

<div class="entry1">
<h3><a name="201204181" title="201204181" href="201204b.html#201204181">■</a> 
Bashのプロンプトでタイトル設定</h3>
<p>
/etcを探しまくっても見つからなくてどこで設定されてんだと思ったら、~/.bashrcにあった。<br>
useradd -mでアカウントを作るともれなくついてくるようだ。/etc/skelの中身がコピーされるんだな。<br>
って、/etcにあるじゃん。どこ探してるんだ、おれは。
</p>
<p>
で、該当するのはこれ。
</p>
<pre>
case &quot;$TERM&quot; in
xterm*|rxvt*)
    PS1=&quot;\[\e]0;${debian_chroot:+($debian_chroot)}\u@\h: \w\a\]$PS1&quot;
    ;;
*)
    ;;
esac
</pre>
<p>
\[から\]で囲まれたところがzshの%{と%}に相当する。<br>
debian_chrootの部分はまあ無視してもかまわないが、<br>
これはdebian_chrootが設定されてればその値を()つきで、そうでなければ空にする技。<br>
単に&quot;($debian_chroot)&quot;では必ず()も表示されてしまうが、空や未設定のときは表示したくないとか、<br>
そういうときに使われる。まあ、結構こういうパターンは悩む。Rubyとかでも。<br>
\aは\007と同じ。
</p>
<p>
注意: なかださんは今までの流れを読んで、これから書く日記のネタをばらさないこと。
</p>
<!-- section end -->
</div>
<!-- 2012/04/18 end -->



<hr class="hide">
<!-- 2012/04/19 start -->
<h2><a name="20120419" href="201204b.html#20120419">2012-04-19 (Thu)</a></h2>

<div class="entry1">
<h3><a name="201204191" title="201204191" href="201204b.html#201204191">■</a> 
PATHに空ディレクトリを追加しない</h3>
<p>
<a href="http://ya.maya.st/d/201204b.html#s20120418_1">LD_LIBRARY_PATHの部分</a>がまさに昨日の:+技が使えるところ。
</p>
<pre>
% LD_LIBRARY_PATH=&quot;/path/to/apache/lib/${LD_LIBRARY_PATH:+:$LD_LIBARARY_PATH}&quot;
% echo $LD_LIBARARY_PATH
/path/to/apache/lib/
% LD_LIBRARY_PATH=&quot;/path/to/apache/lib/${LD_LIBRARY_PATH:+:$LD_LIBARARY_PATH}&quot;
% echo $LD_LIBARARY_PATH
/path/to/apache/lib/:/path/to/apache/lib/
</pre>
<p>
のように初回はLD_LIBRARY_PATHが定義されてないので、空のディレクトリは追加されない。
</p>
<!-- section end -->
</div>
<!-- 2012/04/19 end -->



<hr class="hide">
<!-- 2012/04/20 start -->
<h2><a name="20120420" href="201204b.html#20120420">2012-04-20 (Fri)</a></h2>

<div class="entry1">
<h3><a name="201204201" title="201204201" href="201204b.html#201204201">■</a> 
mvの代わりにrsync</h3>
<p>
先日のカレントディレクトリから1階層下のディレクトリへ移動させる話で、<br>
ディレクトリがなければ作るというコマンドがあれば万事解決するわけなんだけど、<br>
それに近いコマンドがあった。<br>
rsyncはコピーではあるが、転送先ディレクトリがなければ作ってくれる。<br>
そして--remove-source-filesというオプションがある。これと-aを組み合わせれば移動になる。<br>
ただし、そううまい話はころがっていないわけで、mvとは違い挙動はコピーして削除になってしまう。<br>
それとオプション名からもわかるとおり--remove-source-filesはディレクトリを消さない。残念。
</p>
<pre>
% mkdir foo
% touch a b c foo/{d,e,f}
% ls -R
.:
a  b  c  foo

./foo:
d  e  f
% rsync -a --remove-source-files * dir
% ls -R
.:
dir  foo

./dir:
a  b  c  foo

./dir/foo:
d  e  f

./foo:
</pre>
<p>
Rubyのun.rbにこんな挙動するコマンドを仕込んでもいいかもしれない。
</p>
<!-- section end -->
</div>
<!-- 2012/04/20 end -->

<hr>
<div>
<a href="201204a.html">&lt;Older(,)</a> | 
<a href="201204c.html">Newer(.)&gt;</a> | 
<a href="index.html">Recent(/)&gt;&gt;</a>
| <a href="index.rdf">RDF</a>
</div>

<hr>
<!-- SiteSearch Google -->
<form method=GET action="http://www.google.co.jp/search">
<p>
<input type=text name=q size=31 maxlength=255 value="">
<input type=hidden name=hl value="ja">
<input type=hidden name=ie value="UTF-8">
<input type=submit name=btnG value="Google 検索">
<input type=hidden name=domains value="jarp.does.notwork.org"><br>
<input type=radio name=sitesearch value=""> WWW を検索
<input type=radio name=sitesearch value="jarp.does.notwork.org" checked> jarp.does.notwork.org を検索 <br>
</form>

<!-- nsmm v0.6.3.2(2005/08/18) -->

<address><a href="&#109;&#x61;&#x69;&#108;&#116;&#111;&#x3A;&#101;&#98;&#x61;&#110;&#64;&#x6F;&#x73;&#x2E;&#x72;&#105;&#109;&#46;&#x6F;&#x72;&#x2E;&#106;&#x70;">わたなべひろふみ</a><br>
Key fingerprint = C456 1350 085F A320 C6C8  8A36 0F15 9B2E EB12 3885<br>
      <a href="http://validator.w3.org/check?uri=referer"><img
          src="http://www.w3.org/Icons/valid-html401"
          alt="Valid HTML 4.01!" height="16" width="88"></a>

<script type="text/javascript" src="http://trackfeed.com/usr/aa7471e560.js"></script>
</address>

<script src="http://www.google-analytics.com/urchin.js" type="text/javascript">
</script>
<script type="text/javascript">
<!--
_uacct = "UA-101613-1";
urchinTracker();
// -->
</script>
<script src="title.js" type="text/javascript">
</script>
</body>
</html>

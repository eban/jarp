<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "https://www.w3.org/TR/html4/strict.dtd">
<html lang="ja-JP">
<head>
<title>Just another Ruby porter, 2002-7-a</title>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta name="generator" content="nsmm v0.6.3.2(2005/08/18)">
<meta name="author" content="わたなべひろふみ">
<meta http-equiv="Content-Style-Type" content="text/css">
<META http-equiv="Content-Script-Type" content="text/javascript">
<link rel="stylesheet" href="../css/basic.css" type="text/css" media="all">
<link rel="shortcut icon" type="image/x-icon" href="../favicon.ico">
<link rel="icon" type="image/png" href="../favicon.png">
<link rel="alternate" type="application/rss+xml" title="RSS" href="https://jarp.does.notwork.org/jarp/diary/index.rdf">
<link rev="made" href="&#109;&#x61;&#x69;&#108;&#116;&#111;&#x3A;&#101;&#98;&#x61;&#110;&#64;&#x6F;&#x73;&#x2E;&#x72;&#105;&#109;&#46;&#x6F;&#x72;&#x2E;&#106;&#x70;">
<link rel="index" href="./">
<link rel="prev" href="200206c.html">
<link rel="next" href="200207b.html">

</head>
<body>
<div><h1><span>Just another Ruby porter,</span></h1></div>

<p>〜2002年7月上旬〜</p>
<hr>
<div>
<a href="200206c.html" accesskey=",">&lt;Prev(,)</a> | 
<a href="200207b.html" accesskey=".">Next(.)&gt;</a> | 
<a href="index.html" accesskey="/">Recent(/)&gt;&gt;</a>
| <a href="index.rdf">RDF</a>
</div>

<hr>

<!-- 2002/07/01 start -->
<h2><a name="20020701" href="200207a.html#20020701">2002-07-01 (Mon)</a></h2>

<div class="entry1">
<h3><a name="200207011" title="200207011" href="200207a.html#200207011">■</a> 
6月のspam</h3>
<p>
241通。そのうち韓国から74通。
</p>

<!-- section end -->
</div>

<div class="entry0">
<h3><a name="200207012" title="200207012" href="200207a.html#200207012">■</a> 
<a href="http://blade.nagaokaut.ac.jp/cgi-bin/scat.rb/ruby/ruby-talk/43231">[Ruby] Building with Borland or Digital Mars tools?</a></h3>
<p>
やはり聞かれてしまったか。
Digital Marsはfunction prototypeに関して変な癖があって面倒なんだよね。
ちゃんと全部宣言を用意すればいいだけの話かもしれないけど。
</p>

<!-- section end -->
</div>

<div class="entry1">
<h3><a name="200207013" title="200207013" href="200207a.html#200207013">■</a> 
総集編</h3>
<p>
こんなにしゃべる中田を初めて見た。
</p>


<!-- section end -->
</div>
<!-- 2002/07/01 end -->



<hr class="hide">
<!-- 2002/07/02 start -->
<h2><a name="20020702" href="200207a.html#20020702">2002-07-02 (Tue)</a></h2>

<div class="entry1">
<h3><a name="200207021" title="200207021" href="200207a.html#200207021">■</a> 
<a href="http://mingwacr.sourceforge.net/">Mingw32 Alternate C Runtime Library</a></h3>
<pre>
The Mingw32 Alternate C Runtime Library is being developed as a
replacement for the Microsoft C Runtime Library (MSVCRT.DLL) because
there is a need for a C Runtime Library for Mingw32 users which is not
dependent on the Microsoft C Runtime Library, open-source, not
licensed under the GPL or LGPL, and can be used freely for commercial
use. It will be released under the BSD license. This library will be
100% ANSI/ISO compliant, including Unicode functions and ISO C99
functions.
</pre>
<p>
なかなかよさげだ。
</p>

<!-- section end -->
</div>

<div class="entry0">
<h3><a name="200207022" title="200207022" href="200207a.html#200207022">■</a> 
<a href="http://www.ruby-lang.org/en/raa-list.rhtml?name=REXML">[Ruby] REXML 2.3.7</a></h3>
<p>
更新。
</p>


<!-- section end -->
</div>
<!-- 2002/07/02 end -->



<hr class="hide">
<!-- 2002/07/03 start -->
<h2><a name="20020703" href="200207a.html#20020703">2002-07-03 (Wed)</a></h2>

<div class="entry1">
<h3><a name="200207031" title="200207031" href="200207a.html#200207031">■</a> 
[Cygwin] domain</h3>
<p>
結局domainにlogonするのはやめた。
所有権だなんだと変更しまくってるうちにsshdの調子もよくなったようだ。
予想外の展開だ。
</p>


<!-- section end -->
</div>
<!-- 2002/07/03 end -->



<hr class="hide">
<!-- 2002/07/04 start -->
<h2><a name="20020704" href="200207a.html#20020704">2002-07-04 (Thu)</a></h2>

<div class="entry1">
<h3><a name="200207041" title="200207041" href="200207a.html#200207041">■</a> 
<a href="http://cygwin.com/ml/cygwin-announce/2002-07/msg00002.html">Cygwin 1.3.12-1</a></h3>
<pre>
Changes since 1.3.11-3:

- Fix slow startup times.  (Christopher Faylor)
</pre>
<p>
うむ。直ってる。
</p>

<!-- section end -->
</div>

<div class="entry0">
<h3><a name="200207042" title="200207042" href="200207a.html#200207042">■</a> 
<a href="http://tamura.tdiary.net/20020703.html#p01">VIM6</a></h3>
<p>
--enable-rubyinterpは？
</p>


<!-- section end -->
</div>
<!-- 2002/07/04 end -->



<hr class="hide">
<!-- 2002/07/05 start -->
<h2><a name="20020705" href="200207a.html#20020705">2002-07-05 (Fri)</a></h2>

<div class="entry1">
<h3><a name="200207051" title="200207051" href="200207a.html#200207051">■</a> 
<a href="http://www.ruby-lang.org/en/raa-list.rhtml?name=OpenSSL">[Ruby] OpenSSL 0.1.1</a></h3>
<p>
MS_CALLBACKは&lt;openssl/e_os.h&gt;で定義されてるのでossl.hでincludeするようにした。
でもRuby 1.6.7でnet/http.rbが激しく変更されててhttps.rbが使えない。
</p>

<p>
そういえば1.6.7になってget_responseが使えなくなったってだれか言ってたよね。

<a href="http://www.shugo.net/jit/index.rbx?date=20020404#d04:label:0">前田さんだった</a>
。
</p>

<!-- section end -->
</div>

<div class="entry0">
<h3><a name="200207052" title="200207052" href="200207a.html#200207052">■</a> 
<a href="http://sourceforge.jp/projects/skkinput2">skkinput 2.04</a></h3>
<p>
更新。
</p>


<!-- section end -->
</div>
<!-- 2002/07/05 end -->



<hr class="hide">
<!-- 2002/07/06 start -->
<h2><a name="20020706" href="200207a.html#20020706">2002-07-06 (Sat)</a></h2>

<div class="entry1">
<h3><a name="200207061" title="200207061" href="200207a.html#200207061">■</a> 
私立探偵 濱マイク</h3>
<p>
今頃になって録っといたビデオを見る。
小泉今日子はどこにいたんだろう？
景品交換所の女か？
</p>

<!-- section end -->
</div>

<div class="entry0">
<h3><a name="200207062" title="200207062" href="200207a.html#200207062">■</a> 
<a href="http://curl.haxx.se/">cURL</a></h3>
<p>
しまった。--with-ssl=/usr/local/sslを忘れてたか。
</p>
<pre>
curl: (1) libcurl was built with SSL disabled, https: not supported!
</pre>
<p>
でも以前はちゃんと自動的に認識してくれたような気がするんだけどなあ。
</p>

<!-- section end -->
</div>

<div class="entry1">
<h3><a name="200207063" title="200207063" href="200207a.html#200207063">■</a> 
<a href="http://homepage1.nifty.com/~tetsu/ruby/diary/0207.html#2">NIFTY の会議室</a></h3>
<p>
cURLはこれを試すためだったりするんだけど

<a href="#20020706F1"><sup><small>*1</small></sup></a>。
あらかじめ~/.netrcに
</p>
<pre>
machine enter.nifty.com login ABC01234 password himitsu
</pre>
<p>
を、~/.curlrcに
</p>
<pre>
--netrc
</pre>
<p>
を追加し、
</p>
<pre>
% curl --sslv2 -o fgalts.log -F save=on -F logout=on \
  -F /iw/nifty/fgalts/mes/all/index.html=checked \
  https://enter.nifty.com/iw/nifty/mylist/nifty.log
</pre>
<p>
という感じで、ダウンロード可能。
</p>
<pre>
-F /iw/nifty/fgalts/mes/all/index.html=checked
</pre>
<p>
の部分を複数用意すれば巡回も簡単。
allの部分はMREAD ROOM:で指定できるものが書けるというわけではなく、
会議室番号で指定するなら1個しか見てくれない。
</p>
<pre>
-F /iw/nifty/fgalts/mes/1/index.html=checked \
-F /iw/nifty/fgalts/mes/3/index.html=checked \
</pre>
<p>
と面倒でも全部個々に指定するしかない。でも実際は
</p>
<pre>
MREAD ROOM:1,3
</pre>
<p>
になるからそれほど馬鹿じゃないようだ。
形式は見るとわかるんだけど、
なぜかhtmlではなくNIFTYでは見慣れた例のテキスト形式になる。
</p>
<pre>
この発言に対するコメント
https://enter.nifty.com/iw/nifty/FGALTS/mes/1/com.cgi?885
</pre>
<p>
と余計なものがつくのがあれだが、ここに発言の方法のヒントもあるしね。
あとはnif.rbのNifty::log2mailをちょっといじればok。
で、今は

<a href="http://www.ruby-lang.org/en/raa-list.rhtml?name=Ruby%2Flibcurl">Ruby/libcurl</a>
が使えるか模索中。
</p>

<p>
てゆかおれは様子を見てNIFTYをやめる気だったはずじゃ？ま、いいか。
</p>

<hr align="left" width="40%">
<div>
<a name="20020706F1" href="200207a.html#20020706F1"><small>*1</small></a>:
つまり昨日の 
<a href="200207a.html#200207051">OpenSSL</a> も関係してるわけだ。
</div>
<!-- section end -->
</div>

<div class="entry0">
<h3><a name="200207064" title="200207064" href="200207a.html#200207064">■</a> 
<a href="http://sourceforge.net/docman/display_doc.php?docid=10099&amp;group_id=6796">xmake</a></h3>
<p>
AntをC++で実装しなおしたのかと思ったがそういうわけでもなさそう。
</p>
<pre>
% make
cd ./Objects; g++ -DGCC -I../ -c  ../StdAfx.cpp
cd: can't cd to ./Objects
g++: ../StdAfx.cpp: No such file or directory
g++: no input files
make: *** [Objects/StdAfx.o] Error 1
</pre>
<p>
とあらかじめObjects/を掘らないといけないようだ。
あ、configureもあるね。ここでmkdir Objectsしてた。
</p>
<pre>
../CmdLine.cpp: In member function `bool CCmdLine::IsSwitch(const char*)':
../CmdLine.cpp:144: `isdigit' undeclared (first use this function)
../CmdLine.cpp:144: (Each undeclared identifier is reported only once for each
   function it appears in.)
make: *** [Objects/CmdLine.o] Error 1
</pre>
<p>
&lt;ctype.h&gt;をincludeしてないな。
VC++ではなくても許されるってことか？
</p>

<p>
添付のmakefile.xmlにはVC++用しかないのが痛い。すぐに試せない。
でもこのmakefile.xmlを見てもわかりやすくなったとも思えないんだけど。
</p>


<!-- section end -->
</div>
<!-- 2002/07/06 end -->



<hr class="hide">
<!-- 2002/07/07 start -->
<h2><a name="20020707" href="200207a.html#20020707">2002-07-07 (Sun)</a></h2>

<div class="entry1">
<h3><a name="200207071" title="200207071" href="200207a.html#200207071">■</a> 
Linux 2.5.25</h3>
<pre>
PATH=/usr/bin:$PATH make SHELL=/bin/bash bzImage \
  2959.83s user 220.48s system 97% cpu 54:24.66 total
</pre>
<p>
2.4だと1時間10分ぐらいかかってたので-Mp,-MD効果はかなりあるな。
depもmodulesも指定しなくていいのは楽だ。
</p>

<!-- section end -->
</div>

<div class="entry0">
<h3><a name="200207072" title="200207072" href="200207a.html#200207072">■</a> 
[Ruby] Ruby/libcurlでNIFTY</h3>
<p>
curlで実行していたのをそのままscriptに置き換えればいい。
</p>
<pre>
require 'curl'

curl = Curl.new
curl.url = 'https://enter.nifty.com/iw/nifty/mylist/nifty.log'
curl.netrc = true
curl.postfields = 'save=on&amp;logout=on&amp;/iw/nifty/fgalts/mes/all/index.html=checked'
curl.file = 'fgalts.log'
curl.perform
</pre>
<p>
curl.body_strを使ってもいい。
</p>

<!-- section end -->
</div>

<div class="entry1">
<h3><a name="200207073" title="200207073" href="200207a.html#200207073">■</a> 
NIFTYへの発言</h3>
<p>
たとえばfgaltsの3番会議室なら
</p>
<pre>
https://enter.nifty.com/iw/nifty/fgalts/mes/3/uploadgo.cgi
</pre>
<p>
へPOSTすればよさそう。でPOST内容は
</p>
<pre>
title=題名
text=内容
comment=番号
</pre>
<p>
の3つでいいのかなあ。
textはCGI::escapeHTMLする必要あり。
改行もそのまま入れる。
新規発言の場合はcommentは要らない。
で、試すのはちと恐いね。でも試してしまった。
</p>
<pre>
sigtext=
</pre>
<p>
も必要のようだ。
でtextはCGI::escapeHTMLするんじゃなくて、
CGI::escapeぽいことをしないといけない。
日本語はしなくてもいいけど、SJISに変換したほうがよさそう。
そのままCGI::escapeでもいいのかなあ。
これがテストスクリプト。
</p>
<pre>
#!/usr/local/bin/ruby -Ks
require 'curl'

curl = Curl.new
curl.url = 'https://enter.nifty.com/iw/nifty/fgalts/mes/3/uploadgo.cgi'
curl.netrc = true
curl.verbose = true
curl.postfields = 'title=interwayからのテスト&amp;sigtext=&amp;text=わたなべです。

Ruby/libcurlを使った発言テスト。
%26

-- 
わたなべひろふみ'
curl.file = 'say.html'
curl.perform
</pre>
<p>
%26は&amp;のテスト。
</p>

<!-- section end -->
</div>

<div class="entry0">
<h3><a name="200207074" title="200207074" href="200207a.html#200207074">■</a> 
<a href="http://www.ruby-lang.org/en/raa-list.rhtml?name=Ruby+GetText+Package">[Ruby] Ruby GetText Package 0.3.1</a></h3>
<p>
更新。なぜかext/gettext/gettextがコンパイルされないと思ったら、
*.oや*.soが残っているのであった。Linux以外の人は注意。
</p>


<!-- section end -->
</div>
<!-- 2002/07/07 end -->



<hr class="hide">
<!-- 2002/07/08 start -->
<h2><a name="20020708" href="200207a.html#20020708">2002-07-08 (Mon)</a></h2>

<div class="entry1">
<h3><a name="200207081" title="200207081" href="200207a.html#200207081">■</a> 
NIFTY interway</h3>
<p>

<a href="http://www.ruby-lang.org/en/raa-list.rhtml?name=Ruby%2Flibcurl">Ruby/libcurl</a>
を使って発言のテストをするときは、POSTの
</p>
<pre>
sigtext=
</pre>
<p>
を省略する。このときに
</p>
<pre>
『戻る』ボタンまたはログアウト後に、直接発言を登録することはできませ
ん。再度作成から行ってください。
</pre>
<p>
というエラーになり、発言内容が表示されるので確認できるわけだ。
</p>

<p>
とりあえずnif.rbを使わなくてもいい環境はできそうだ。
</p>

<!-- section end -->
</div>

<div class="entry0">
<h3><a name="200207082" title="200207082" href="200207a.html#200207082">■</a> 
[Cygwin] Cygwin 1.3.12-2</h3>
<p>
こっそり用意されてる。
</p>

<!-- section end -->
</div>

<div class="entry1">
<h3><a name="200207083" title="200207083" href="200207a.html#200207083">■</a> 
<a href="http://cygwin.com/ml/cygwin/2002-07/msg00477.html">[Cygwin] Available for test: gcc-3.1.1-1, gcc2-2.95.3-6, and gcc-mingw-3_1-20020516-1</a></h3>
<p>
gcc 3.1.1だけど、
syslimits.hがないとか、
specsの変更で-mwin32しないと&lt;windows.h&gt;がみつからないとか、
いろいろまずいとこがある。
特に-mwin32に関してはwindresと絡むため、かなりまずい。
</p>


<!-- section end -->
</div>
<!-- 2002/07/08 end -->



<hr class="hide">
<!-- 2002/07/09 start -->
<h2><a name="20020709" href="200207a.html#20020709">2002-07-09 (Tue)</a></h2>

<div class="entry1">
<h3><a name="200207091" title="200207091" href="200207a.html#200207091">■</a> 
<a href="http://cygwin.com/ml/cygwin/2002-07/msg00477.html">[Cygwin] Available for test: gcc-3.1.1-1, gcc2-2.95.3-6, and gcc-mingw-3_1-20020516-1</a></h3>
<p>
書き忘れてた。specsの-mwin32の部分だけどこうなってる。
例によって見やすいように適当に改行を入れる。
</p>
<pre>
%{mwin32|mno-cygwin: \
  -DWIN32 -D_WIN32 -D__WIN32 -D__WIN32__  \
  %{!ansi:-DWINNT} \
  -isystem ../include/w32api%s \
  -isystem ../../include/w32api%s \
 }
</pre>
<p>
この-isystemなんだけど、%sは
</p>
<pre>
/usr/lib/gcc-lib/i686-pc-cygwin/3.1.1
</pre>
<p>
からの相対を意味する。展開し、正規化すると
</p>
<pre>
  -isystem /usr/lib/gcc-lib/i686-pc-cygwin/include/w32api \
  -isystem /usr/lib/gcc-lib/include/w32api \
</pre>
<p>
となるが、もちろんそんなとこにはない。全くの無駄な指定だ。この場合の正解は
</p>
<pre>
  -isystem ../../../../include/w32api%s \
</pre>
<p>
だと思う。
</p>

<p>
実はそのあたりの個数を数えるのが面倒なので
</p>
<pre>
  -isystem /usr/include/w32api \
</pre>
<p>
としてしまった。すでにuninstallしちゃったから次の更新時に確認しよう。
</p>

<!-- section end -->
</div>

<div class="entry0">
<h3><a name="200207092" title="200207092" href="200207a.html#200207092">■</a> 
<a href="http://www.ruby-lang.org/en/raa-list.rhtml?name=REXML-stable">[Ruby] REXML 2.4.0</a></h3>
<p>
更新。
</p>


<!-- section end -->
</div>
<!-- 2002/07/09 end -->



<hr class="hide">
<!-- 2002/07/10 start -->
<h2><a name="20020710" href="200207a.html#20020710">2002-07-10 (Wed)</a></h2>

<div class="entry1">
<h3><a name="200207101" title="200207101" href="200207a.html#200207101">■</a> 
[zsh] history-beginning-search-backward-end</h3>
<p>
UNIX USERの8月号から:
</p>
<pre>
autoload history-search-end
zle -N history-beginning-search-backward-end history-search-end
zle -N history-beginning-search-forward-end history-search-end
bindkey '^p' history-beginning-search-backward-end
bindkey '^n' history-beginning-search-forward-end
</pre>
<p>
これでtcshと同じ挙動になる。
</p>

<!-- section end -->
</div>

<div class="entry0">
<h3><a name="200207102" title="200207102" href="200207a.html#200207102">■</a> 
<a href="200207a.html#200207091">[Cygwin] gcc 3.1.1</a></h3>
<p>
あぁ、全然違う。
</p>
<pre>
  -isystem ../include/w32api%s \
  -isystem ../../include/w32api%s \
</pre>
<p>
で合ってる。見つからないのは
</p>
<pre>
%{mwin32|mno-cygwin: \
</pre>
<p>
の所為だったんだ。%sは
</p>
<pre>
Current argument is the name of a library or startup file of some
sort.  Search for that file in a standard list of directories and
substitute the full name found.
</pre>
<p>
なので、これっていろいろ試しまくるんだね。どういう順番になるのかな。
gcc --print-search-dirsのlibrariesがどうもあやしい。
Linux上で実験してみる。
</p>
<pre>
% gcc --print-search-dirs |\
  ruby -ne '$_.split(/[ :=]+/)[1..-1].each{|i|puts File.expand_path(i)} if /^lib/'
/usr/local/lib/gcc-lib/i586-pc-linux-gnu/3.1
/usr/lib/gcc/i586-pc-linux-gnu/3.1
/usr/local/i586-pc-linux-gnu/lib/i586-pc-linux-gnu/3.1
/usr/local/i586-pc-linux-gnu/lib
/usr/local/lib/i586-pc-linux-gnu/3.1
/usr/local/lib
/lib/i586-pc-linux-gnu/3.1
/lib
/usr/lib/i586-pc-linux-gnu/3.1
/usr/lib/
</pre>
<p>
存在しない/usr/lib/gcc/i586-pc-linux-gnu/3.1で試そう。
</p>
<pre>
% sudo mkdir -p /usr/lib/gcc/i586-pc-linux-gnu/3.1/foo
% echo '*cpp: -isystem foo%s' &gt;foo.specs
% gcc -specs=foo.specs -v -E hoge.c |&amp; sed -n '/^#i/,/^End/p'    
#include &quot;...&quot; search starts here:
#include &lt;...&gt; search starts here:
 /usr/lib/gcc/i586-pc-linux-gnu/3.1/foo
 /usr/local/include
 /usr/local/lib/gcc-lib/i586-pc-linux-gnu/3.1/include
 /usr/include
End of search list.
</pre>
<p>
やっぱそうみたいだ。
</p>

<p>
rubyがエラーになるのには変わらないけど、
</p>
<pre>
%{mwin32|mno-cygwin:
</pre>
<p>
を
</p>
<pre>
%{!mno-win32:
</pre>
<p>
とすればとりあえずいける。
でも、systemがNoMemoryErrorになるので拡張ライブラリがmakeできない。
file.cだけgcc-2でコンパイルすれば大丈夫だ。なんかいやな感じ。
</p>


<!-- section end -->
</div>
<!-- 2002/07/10 end -->

<hr>
<div>
<a href="200206c.html">&lt;Prev(,)</a> | 
<a href="200207b.html">Next(.)&gt;</a> | 
<a href="index.html">Recent(/)&gt;&gt;</a>
| <a href="index.rdf">RDF</a>
</div>

<hr>
<!-- SiteSearch Google -->
<form method=GET action="https://www.google.co.jp/search">
<p>
<input type=text name=q size=31 maxlength=255 value="">
<input type=hidden name=hl value="ja">
<input type=hidden name=ie value="UTF-8">
<input type=submit name=btnG value="Google 検索">
<input type=hidden name=domains value="jarp.does.notwork.org"><br>
<input type=radio name=sitesearch value=""> WWW を検索
<input type=radio name=sitesearch value="jarp.does.notwork.org" checked> jarp.does.notwork.org を検索 <br>
</form>

<!-- nsmm v0.6.3.2(2005/08/18) -->

<address><a href="&#109;&#x61;&#x69;&#108;&#116;&#111;&#x3A;&#101;&#98;&#x61;&#110;&#64;&#x6F;&#x73;&#x2E;&#x72;&#105;&#109;&#46;&#x6F;&#x72;&#x2E;&#106;&#x70;">わたなべひろふみ</a><br>
Key fingerprint = C456 1350 085F A320 C6C8  8A36 0F15 9B2E EB12 3885<br>
      <a href="https://validator.w3.org/check?uri=referer"><img
          src="https://www.w3.org/Icons/valid-html401"
          alt="Valid HTML 4.01!" height="16" width="88"></a>

<script type="text/javascript" src="http://trackfeed.com/usr/aa7471e560.js"></script>
</address>

<script src="https://www.google-analytics.com/urchin.js" type="text/javascript">
</script>
<script type="text/javascript">
<!--
_uacct = "UA-101613-1";
urchinTracker();
// -->
</script>
<script src="title.js" type="text/javascript">
</script>
</body>
</html>
